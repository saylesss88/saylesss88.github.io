<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>My-Nix-Blog</title>
    <!-- <link rel="stylesheet" href="https://saylesss88.github.io/style.css" /> -->
    <script>
      const baseUrl = "https://saylesss88.github.io";
    </script>
  </head>
  <body>
    <div class="container">
      <h1>Welcome to My-Nix-Blog</h1>

      <button id="dark-mode-toggle">Toggle Dark Mode</button>

      <a href="https://saylesss88.github.io/rss.xml" id="rss-button" role="button">
        ðŸ“¡ Subscribe via RSS
      </a>

      <div role="search">
        <input
          type="text"
          id="search"
          placeholder="Search..."
          aria-label="Search"
        />
        <div class="search-results" aria-live="polite">
          <ul class="search-results__items"></ul>
        </div>
      </div>

      
  &lt;p&gt;&lt;strong&gt;TOC&lt;&#x2F;strong&gt;&lt;&#x2F;p&gt;
&lt;!--toc:start--&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https:&#x2F;&#x2F;saylesss88.github.io&#x2F;blog&#x2F;working-with-nixpkgs-locally&#x2F;#working-with-nixpkgs-locally-benefits-and-best-practices&quot;&gt;Working with Nixpkgs Locally: Benefits and Best Practices&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;
&lt;li&gt;&lt;a href=&quot;https:&#x2F;&#x2F;saylesss88.github.io&#x2F;blog&#x2F;working-with-nixpkgs-locally&#x2F;#i-why-work-with-nixpkgs-locally&quot;&gt;I. Why Work with Nixpkgs Locally?&lt;&#x2F;a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https:&#x2F;&#x2F;saylesss88.github.io&#x2F;blog&#x2F;working-with-nixpkgs-locally&#x2F;#a-faster-development-cycle&quot;&gt;A. Faster Development Cycle&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;
&lt;li&gt;&lt;a href=&quot;https:&#x2F;&#x2F;saylesss88.github.io&#x2F;blog&#x2F;working-with-nixpkgs-locally&#x2F;#b-enhanced-version-control&quot;&gt;B. Enhanced Version Control&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;
&lt;li&gt;&lt;a href=&quot;https:&#x2F;&#x2F;saylesss88.github.io&#x2F;blog&#x2F;working-with-nixpkgs-locally&#x2F;#c-flexible-debugging-capabilities&quot;&gt;C. Flexible Debugging Capabilities&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;
&lt;li&gt;&lt;a href=&quot;https:&#x2F;&#x2F;saylesss88.github.io&#x2F;blog&#x2F;working-with-nixpkgs-locally&#x2F;#d-streamlined-contribution-workflow&quot;&gt;D. Streamlined Contribution Workflow&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;
&lt;li&gt;&lt;a href=&quot;https:&#x2F;&#x2F;saylesss88.github.io&#x2F;blog&#x2F;working-with-nixpkgs-locally&#x2F;#e-up-to-date-documentation-source&quot;&gt;E. Up-to-Date Documentation Source&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;
&lt;li&gt;&lt;a href=&quot;https:&#x2F;&#x2F;saylesss88.github.io&#x2F;blog&#x2F;working-with-nixpkgs-locally&#x2F;#f-optimized-storage-and-performance&quot;&gt;F. Optimized Storage and Performance&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;&lt;a href=&quot;https:&#x2F;&#x2F;saylesss88.github.io&#x2F;blog&#x2F;working-with-nixpkgs-locally&#x2F;#ii-flake-vs-non-flake-syntax-for-local-nixpkgs&quot;&gt;II. Flake vs. Non-Flake Syntax for Local Nixpkgs&lt;&#x2F;a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https:&#x2F;&#x2F;saylesss88.github.io&#x2F;blog&#x2F;working-with-nixpkgs-locally&#x2F;#a-flake-syntax-nix-build-package&quot;&gt;A. Flake Syntax (&lt;code&gt;nix build .#&amp;lt;package&amp;gt;&lt;&#x2F;code&gt;)&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;
&lt;li&gt;&lt;a href=&quot;https:&#x2F;&#x2F;saylesss88.github.io&#x2F;blog&#x2F;working-with-nixpkgs-locally&#x2F;#b-non-flake-syntax-nix-build-f-package-or-nix-build-f-package&quot;&gt;B. Non-Flake Syntax (&lt;code&gt;nix-build -f . &amp;lt;package&amp;gt;&lt;&#x2F;code&gt; or &lt;code&gt;nix build -f . &amp;lt;package&amp;gt;&lt;&#x2F;code&gt;)&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;
&lt;li&gt;&lt;a href=&quot;https:&#x2F;&#x2F;saylesss88.github.io&#x2F;blog&#x2F;working-with-nixpkgs-locally&#x2F;#iii-setting-up-a-local-nixpkgs-repository-efficiently&quot;&gt;III. Setting Up a Local Nixpkgs Repository Efficiently&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;
&lt;li&gt;&lt;a href=&quot;https:&#x2F;&#x2F;saylesss88.github.io&#x2F;blog&#x2F;working-with-nixpkgs-locally&#x2F;#a-initial-clone-shallow-cloning&quot;&gt;A. Initial Clone: Shallow Cloning&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;
&lt;li&gt;&lt;a href=&quot;https:&#x2F;&#x2F;saylesss88.github.io&#x2F;blog&#x2F;working-with-nixpkgs-locally&#x2F;#b-managing-branches-with-worktrees&quot;&gt;B. Managing Branches with Worktrees&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;&lt;a href=&quot;https:&#x2F;&#x2F;saylesss88.github.io&#x2F;blog&#x2F;working-with-nixpkgs-locally&#x2F;#iv-debugging-missing-dependencies-a-practical-example&quot;&gt;IV. Debugging Missing Dependencies: A Practical Example&lt;&#x2F;a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https:&#x2F;&#x2F;saylesss88.github.io&#x2F;blog&#x2F;working-with-nixpkgs-locally&#x2F;#b-local-source-code-search-with-rg-ripgrep&quot;&gt;B. Local Source Code Search with &lt;code&gt;rg&lt;&#x2F;code&gt; (ripgrep)&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;&lt;a href=&quot;https:&#x2F;&#x2F;saylesss88.github.io&#x2F;blog&#x2F;working-with-nixpkgs-locally&#x2F;#v-local-derivation-search-with-nix-locate&quot;&gt;V. Local Derivation Search with &lt;code&gt;nix-locate&lt;&#x2F;code&gt;&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;
&lt;li&gt;&lt;a href=&quot;https:&#x2F;&#x2F;saylesss88.github.io&#x2F;blog&#x2F;working-with-nixpkgs-locally&#x2F;#vi-key-benefits-of-working-with-nixpkgs-locally-recap&quot;&gt;VI. Key Benefits of Working with Nixpkgs Locally (Recap)&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;
&lt;li&gt;&lt;a href=&quot;https:&#x2F;&#x2F;saylesss88.github.io&#x2F;blog&#x2F;working-with-nixpkgs-locally&#x2F;#vii-best-practices-and-tips-from-the-community&quot;&gt;VII. Best Practices and Tips from the Community&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;!--toc:end--&gt;
&lt;img src=&quot;&#x2F;images&#x2F;gruv7.png&quot; alt=&quot;Cyber&quot; width=&quot;700&quot;&gt;
&lt;h1 id=&quot;working-with-nixpkgs-locally-benefits-and-best-practices&quot;&gt;Working with Nixpkgs Locally: Benefits and Best Practices&lt;&#x2F;h1&gt;
&lt;ul&gt;
&lt;li&gt;Nixpkgs, the package repository for NixOS, is a powerful resource for building and customizing software.&lt;&#x2F;li&gt;
&lt;li&gt;Working with a local copy enhances development, debugging, and contribution workflows.&lt;&#x2F;li&gt;
&lt;li&gt;This post covers setting up a local Nixpkgs repository, searching for dependencies, and leveraging its advantages, incorporating tips from the Nix community.&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;h1 id=&quot;i-why-work-with-nixpkgs-locally&quot;&gt;I. Why Work with Nixpkgs Locally?&lt;&#x2F;h1&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;A local Nixpkgs repository offers significant advantages for Nix developers:&lt;&#x2F;p&gt;
&lt;h2 id=&quot;a-faster-development-cycle&quot;&gt;A. Faster Development Cycle&lt;&#x2F;h2&gt;
&lt;ul&gt;
&lt;li&gt;Local searches for packages and dependencies are significantly quicker than querying remote repositories or channels.&lt;&#x2F;li&gt;
&lt;li&gt;This speedup is crucial for efficient debugging and rapid prototyping of Nix expressions.&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;h2 id=&quot;b-enhanced-version-control&quot;&gt;B. Enhanced Version Control&lt;&#x2F;h2&gt;
&lt;ul&gt;
&lt;li&gt;By pinning your local repository to specific commits or branches (e.g., &lt;code&gt;nixos-unstable&lt;&#x2F;code&gt;), you ensure build reproducibility.&lt;&#x2F;li&gt;
&lt;li&gt;This prevents unexpected issues arising from upstream changes in Nixpkgs.&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;h2 id=&quot;c-flexible-debugging-capabilities&quot;&gt;C. Flexible Debugging Capabilities&lt;&#x2F;h2&gt;
&lt;ul&gt;
&lt;li&gt;You can directly test and modify package derivations within your local copy.&lt;&#x2F;li&gt;
&lt;li&gt;This allows for quick fixes to issues like missing dependencies without waiting for upstream updates or releases.&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;h2 id=&quot;d-streamlined-contribution-workflow&quot;&gt;D. Streamlined Contribution Workflow&lt;&#x2F;h2&gt;
&lt;ul&gt;
&lt;li&gt;Developing and testing new packages or patches locally is essential before submitting them as pull requests to Nixpkgs.&lt;&#x2F;li&gt;
&lt;li&gt;A local setup provides an isolated environment for experimentation.&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;h2 id=&quot;e-up-to-date-documentation-source&quot;&gt;E. Up-to-Date Documentation Source&lt;&#x2F;h2&gt;
&lt;ul&gt;
&lt;li&gt;The source code and comments within the Nixpkgs repository often contain the most current information about packages.&lt;&#x2F;li&gt;
&lt;li&gt;This can sometimes be more up-to-date than official, external documentation.&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;h2 id=&quot;f-optimized-storage-and-performance&quot;&gt;F. Optimized Storage and Performance&lt;&#x2F;h2&gt;
&lt;ul&gt;
&lt;li&gt;Employing efficient cloning strategies (e.g., shallow clones) and avoiding unnecessary practices (like directly using Nixpkgs as a flake for local development) minimizes disk usage and build times.&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;h1 id=&quot;ii-flake-vs-non-flake-syntax-for-local-nixpkgs&quot;&gt;II. Flake vs. Non-Flake Syntax for Local Nixpkgs&lt;&#x2F;h1&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;When working with Nixpkgs locally, the choice between Flake and non-Flake syntax has implications for performance and storage:&lt;&#x2F;p&gt;
&lt;h2 id=&quot;a-flake-syntax-nix-build-package&quot;&gt;A. Flake Syntax (&lt;code&gt;nix build .#&amp;lt;package&amp;gt;&lt;&#x2F;code&gt;)&lt;&#x2F;h2&gt;
&lt;ul&gt;
&lt;li&gt;Treats the current directory as a flake, requiring evaluation of &lt;code&gt;flake.nix&lt;&#x2F;code&gt;.&lt;&#x2F;li&gt;
&lt;li&gt;For local Nixpkgs, this evaluates the flake definition in the repository root.&lt;&#x2F;li&gt;
&lt;li&gt;&lt;strong&gt;Performance and Storage Overhead:&lt;&#x2F;strong&gt; Flakes copy the entire working directory (including Git history if present) to &lt;code&gt;&#x2F;nix&#x2F;store&lt;&#x2F;code&gt; for evaluation. This can be slow and storage-intensive for large repositories like Nixpkgs.&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;h2 id=&quot;b-non-flake-syntax-nix-build-f-package-or-nix-build-f-package&quot;&gt;B. Non-Flake Syntax (&lt;code&gt;nix-build -f . &amp;lt;package&amp;gt;&lt;&#x2F;code&gt; or &lt;code&gt;nix build -f . &amp;lt;package&amp;gt;&lt;&#x2F;code&gt;)&lt;&#x2F;h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-f .&lt;&#x2F;code&gt; specifies the Nix expression (e.g., &lt;code&gt;default.nix&lt;&#x2F;code&gt; or a specific file) in the current directory.&lt;&#x2F;li&gt;
&lt;li&gt;&lt;strong&gt;Efficiency:&lt;&#x2F;strong&gt; Evaluates the Nix expression directly &lt;em&gt;without&lt;&#x2F;em&gt; copying the entire worktree to &lt;code&gt;&#x2F;nix&#x2F;store&lt;&#x2F;code&gt;. This is significantly faster and more storage-efficient for local development on large repositories.&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;h2 id=&quot;iii-setting-up-a-local-nixpkgs-repository-efficiently&quot;&gt;III. Setting Up a Local Nixpkgs Repository Efficiently&lt;&#x2F;h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Cloning Nixpkgs requires careful consideration due to its size.&lt;&#x2F;p&gt;
&lt;h2 id=&quot;a-initial-clone-shallow-cloning&quot;&gt;A. Initial Clone: Shallow Cloning&lt;&#x2F;h2&gt;
&lt;ul&gt;
&lt;li&gt;To avoid downloading the entire history, perform a shallow clone:&lt;pre data-lang=&quot;bash&quot; style=&quot;background-color:#212733;color:#ccc9c2;&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span style=&quot;color:#ffd580;&quot;&gt;git&lt;&#x2F;span&gt;&lt;span&gt; clone &lt;&#x2F;span&gt;&lt;span style=&quot;color:#ffa759;&quot;&gt;[&lt;&#x2F;span&gt;&lt;span&gt;https:&#x2F;&#x2F;github.com&#x2F;NixOS&#x2F;nixpkgs&lt;&#x2F;span&gt;&lt;span style=&quot;color:#ffa759;&quot;&gt;]&lt;&#x2F;span&gt;&lt;span&gt;(https:&#x2F;&#x2F;github.com&#x2F;NixOS&#x2F;nixpkgs) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#ffd580;&quot;&gt;--depth&lt;&#x2F;span&gt;&lt;span&gt; 1
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#f28779;&quot;&gt;cd&lt;&#x2F;span&gt;&lt;span&gt; nixpkgs
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;h2 id=&quot;b-managing-branches-with-worktrees&quot;&gt;B. Managing Branches with Worktrees&lt;&#x2F;h2&gt;
&lt;ul&gt;
&lt;li&gt;Use Git worktrees to manage different branches efficiently:&lt;pre data-lang=&quot;bash&quot; style=&quot;background-color:#212733;color:#ccc9c2;&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span style=&quot;color:#ffd580;&quot;&gt;git&lt;&#x2F;span&gt;&lt;span&gt; fetch&lt;&#x2F;span&gt;&lt;span style=&quot;color:#ffcc66;&quot;&gt; --all --prune --depth&lt;&#x2F;span&gt;&lt;span style=&quot;color:#f29e74;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt;1
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#ffd580;&quot;&gt;git&lt;&#x2F;span&gt;&lt;span&gt; worktree add&lt;&#x2F;span&gt;&lt;span style=&quot;color:#ffcc66;&quot;&gt; -b&lt;&#x2F;span&gt;&lt;span&gt; nixos-unstable nixos-unstable &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#5c6773;&quot;&gt;# For just unstable
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;&lt;strong&gt;Explanation of &lt;code&gt;git worktree&lt;&#x2F;code&gt;:&lt;&#x2F;strong&gt; Allows multiple working directories attached to the same &lt;code&gt;.git&lt;&#x2F;code&gt; directory, sharing history and objects but with separate checked-out files.&lt;&#x2F;li&gt;
&lt;li&gt;&lt;code&gt;git worktree add&lt;&#x2F;code&gt;: Creates a new working directory for the specified branch (&lt;code&gt;nixos-unstable&lt;&#x2F;code&gt; in this case).&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;h1 id=&quot;iv-debugging-missing-dependencies-a-practical-example&quot;&gt;IV. Debugging Missing Dependencies: A Practical Example&lt;&#x2F;h1&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Let&#x27;s say you&#x27;re trying to build &lt;code&gt;icat&lt;&#x2F;code&gt; locally and encounter a missing dependency error:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;nix&quot; style=&quot;background-color:#212733;color:#ccc9c2;&quot; class=&quot;language-nix &quot;&gt;&lt;code class=&quot;language-nix&quot; data-lang=&quot;nix&quot;&gt;&lt;span style=&quot;color:#ffcc66;&quot;&gt;nix-build &lt;&#x2F;span&gt;&lt;span style=&quot;color:#f29e74;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span style=&quot;color:#ffcc66;&quot;&gt;A icat
&lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#5c6773;&quot;&gt;# ... (Error log showing &amp;quot;fatal error: X11&#x2F;Xlib.h: No such file or directory&amp;quot;)
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;ul&gt;
&lt;li&gt;The error &lt;code&gt;fatal error: X11&#x2F;Xlib.h: No such file or directory&lt;&#x2F;code&gt; indicates a missing X11 dependency.&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;h2 id=&quot;a-online-search-with-search-nixos-org&quot;&gt;A. Online Search with &lt;code&gt;search.nixos.org&lt;&#x2F;code&gt;&lt;&#x2F;h2&gt;
&lt;ul&gt;
&lt;li&gt;The Nixpkgs package search website (&lt;a href=&quot;https:&#x2F;&#x2F;search.nixos.org&#x2F;packages&quot;&gt;https:&#x2F;&#x2F;search.nixos.org&#x2F;packages&lt;&#x2F;a&gt;) is a valuable first step.&lt;&#x2F;li&gt;
&lt;li&gt;However, broad terms like &quot;x11&quot; can yield many irrelevant results.&lt;&#x2F;li&gt;
&lt;li&gt;&lt;strong&gt;Tip:&lt;&#x2F;strong&gt; Utilize the left sidebar to filter by package sets (e.g., &quot;xorg&quot;).&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;h2 id=&quot;b-local-source-code-search-with-rg-ripgrep&quot;&gt;B. Local Source Code Search with &lt;code&gt;rg&lt;&#x2F;code&gt; (ripgrep)&lt;&#x2F;h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Familiarity with searching the Nixpkgs source code is crucial for finding dependencies.&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;Navigate to your local &lt;code&gt;nixpkgs&#x2F;&lt;&#x2F;code&gt; directory and use &lt;code&gt;rg&lt;&#x2F;code&gt;:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; style=&quot;background-color:#212733;color:#ccc9c2;&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span style=&quot;color:#ffd580;&quot;&gt;rg &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bae67e;&quot;&gt;&amp;quot;x11 =&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt; pkgs &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#5c6773;&quot;&gt;# Case-sensitive search
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;&lt;strong&gt;Output:&lt;&#x2F;strong&gt;&lt;&#x2F;p&gt;
&lt;pre style=&quot;background-color:#212733;color:#ccc9c2;&quot;&gt;&lt;code&gt;&lt;span&gt;pkgs&#x2F;tools&#x2F;X11&#x2F;primus&#x2F;default.nix
&lt;&#x2F;span&gt;&lt;span&gt;21:  primus = if useNvidia then primusLib_ else primusLib_.override { nvidia_x11 = null; };
&lt;&#x2F;span&gt;&lt;span&gt;22:  primus_i686 = if useNvidia then primusLib_i686_ else primusLib_i686_.override { nvidia_x11 = null; };
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;pkgs&#x2F;applications&#x2F;graphics&#x2F;imv&#x2F;default.nix
&lt;&#x2F;span&gt;&lt;span&gt;38:    x11 = [ libGLU xorg.libxcb xorg.libX11 ];
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;Refining the search (case-insensitive):&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; style=&quot;background-color:#212733;color:#ccc9c2;&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span style=&quot;color:#ffd580;&quot;&gt;rg&lt;&#x2F;span&gt;&lt;span style=&quot;color:#ffcc66;&quot;&gt; -i &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bae67e;&quot;&gt;&amp;quot;libx11 =&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt; pkgs
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;&lt;strong&gt;Output:&lt;&#x2F;strong&gt;&lt;&#x2F;p&gt;
&lt;pre style=&quot;background-color:#212733;color:#ccc9c2;&quot;&gt;&lt;code&gt;&lt;span&gt;# ... (Output showing &amp;quot;xorg.libX11&amp;quot;)
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;The key result is &lt;code&gt;xorg.libX11&lt;&#x2F;code&gt;, which is likely the missing dependency.&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;h1 id=&quot;v-local-derivation-search-with-nix-locate&quot;&gt;V. Local Derivation Search with &lt;code&gt;nix-locate&lt;&#x2F;code&gt;&lt;&#x2F;h1&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;nix-locate&lt;&#x2F;code&gt; (from the &lt;code&gt;nix-index&lt;&#x2F;code&gt; package) allows searching for derivations on the command line.&lt;&#x2F;p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;Note:&lt;&#x2F;strong&gt; Install &lt;code&gt;nix-index&lt;&#x2F;code&gt; and run &lt;code&gt;nix-index&lt;&#x2F;code&gt; to create the initial index.&lt;&#x2F;p&gt;
&lt;&#x2F;blockquote&gt;
&lt;pre data-lang=&quot;bash&quot; style=&quot;background-color:#212733;color:#ccc9c2;&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span style=&quot;color:#ffd580;&quot;&gt;nix-locate&lt;&#x2F;span&gt;&lt;span&gt; libx11
&lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#5c6773;&quot;&gt;# ... (Output showing paths related to libx11)
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;Combining online and local search tools (&lt;code&gt;search.nixos.org&lt;&#x2F;code&gt;, &lt;code&gt;rg&lt;&#x2F;code&gt;, &lt;code&gt;nix-locate&lt;&#x2F;code&gt;) provides a comprehensive approach to finding dependencies.&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;h1 id=&quot;vi-key-benefits-of-working-with-nixpkgs-locally-recap&quot;&gt;VI. Key Benefits of Working with Nixpkgs Locally (Recap)&lt;&#x2F;h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Speed:&lt;&#x2F;strong&gt; Faster searches and builds compared to remote operations.&lt;&#x2F;li&gt;
&lt;li&gt;&lt;strong&gt;Control:&lt;&#x2F;strong&gt; Full control over the Nixpkgs version.&lt;&#x2F;li&gt;
&lt;li&gt;&lt;strong&gt;Up-to-Date Information:&lt;&#x2F;strong&gt; Repository source often has the latest details.&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;h1 id=&quot;vii-best-practices-and-tips-from-the-community&quot;&gt;VII. Best Practices and Tips from the Community&lt;&#x2F;h1&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Rebasing over Merging:&lt;&#x2F;strong&gt; Never merge upstream changes into your local branch. Always rebase your branch onto the upstream (e.g., &lt;code&gt;master&lt;&#x2F;code&gt; or &lt;code&gt;nixos-unstable&lt;&#x2F;code&gt;) to avoid accidental large-scale pings in pull requests (Tip from &lt;code&gt;soulsssx3&lt;&#x2F;code&gt; on Reddit).&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Tip from &lt;code&gt;ElvishJErrico&lt;&#x2F;code&gt;:&lt;&#x2F;strong&gt; Avoid using Nixpkgs directly as a flake for local development due to slow copying to &lt;code&gt;&#x2F;nix&#x2F;store&lt;&#x2F;code&gt; and performance issues with garbage collection on large numbers of small files. Use &lt;code&gt;nix build -f . &amp;lt;package&amp;gt;&lt;&#x2F;code&gt; instead of &lt;code&gt;nix build .#&amp;lt;package&amp;gt;&lt;&#x2F;code&gt;.&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Edge Cases for Flake Syntax:&lt;&#x2F;strong&gt; Flake syntax might be necessary in specific scenarios, such as NixOS installer tests where copying the Git history should be avoided.&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Base Changes on &lt;code&gt;nixos-unstable&lt;&#x2F;code&gt;:&lt;&#x2F;strong&gt; For better binary cache hits, base your changes on the &lt;code&gt;nixos-unstable&lt;&#x2F;code&gt; branch instead of &lt;code&gt;master&lt;&#x2F;code&gt;. Consider the merge-base for staging branches as well.&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Consider &lt;code&gt;jujutsu&lt;&#x2F;code&gt;:&lt;&#x2F;strong&gt; Explore &lt;code&gt;jujutsu&lt;&#x2F;code&gt;, a Git-compatible alternative that can offer a more intuitive workflow, especially for large monorepos like Nixpkgs. While it has a learning curve, it can significantly improve parallel work and branch management.&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;


    </div>

    <script defer src="https://saylesss88.github.io/elasticlunr.min.js"></script>
    <script defer>
      let index;

      fetch(`${baseUrl}/search_index.en.json`)
        .then((response) => response.json())
        .then((data) => {
          index = elasticlunr.Index.load(data);

          const searchInput = document.getElementById("search");
          const resultsContainer = document.querySelector(".search-results");
          const resultsList = document.querySelector(".search-results__items");

          searchInput.addEventListener("input", (e) => {
            const query = e.target.value.trim();

            if (!query || !index) {
              resultsContainer.style.display = "none";
              resultsList.innerHTML = "";
              return;
            }

            const results = index.search(query, { expand: true });

            if (results.length > 0) {
              resultsList.innerHTML = results
                .map((result) => {
                  const ref = index.documentStore.getDoc(result.ref);
                  return `<li><a href="${ref.permalink}">${ref.title}</a></li>`;
                })
                .join("");
              resultsContainer.style.display = "block";
            } else {
              resultsList.innerHTML = "<li>No results found.</li>";
              resultsContainer.style.display = "block";
            }
          });
        })
        .catch((err) => {
          console.error("Search index failed to load:", err);
        });
    </script>

    <script defer>
      document.addEventListener("DOMContentLoaded", () => {
        const darkModeToggle = document.getElementById("dark-mode-toggle");
        const body = document.body;

        const savedTheme = localStorage.getItem("theme") || "light";

        // Apply the saved theme on load
        if (savedTheme === "dark") {
          body.classList.add("dark-mode");
        }

        darkModeToggle.addEventListener("click", () => {
          body.classList.toggle("dark-mode");
          const currentTheme = body.classList.contains("dark-mode")
            ? "dark"
            : "light";
          localStorage.setItem("theme", currentTheme);
        });
      });
    </script>
  </body>
</html>
