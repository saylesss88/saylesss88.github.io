<!DOCTYPE HTML>
<html lang="en" class="coal sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Intro to Nushell on NixOS - nix-book</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon-de23e50b.svg">
        <link rel="shortcut icon" href="favicon-8114d1fc.png">
        <link rel="stylesheet" href="css/variables-8adf115d.css">
        <link rel="stylesheet" href="css/general-2459343d.css">
        <link rel="stylesheet" href="css/chrome-ca6ed5dd.css">
        <link rel="stylesheet" href="css/print-9e4910d8.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="fonts/fonts-9644e21d.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="mdbook-highlight-css" href="highlight-493f70e1.css">
        <link rel="stylesheet" id="mdbook-tomorrow-night-css" href="tomorrow-night-4c0ae647.css">
        <link rel="stylesheet" id="mdbook-ayu-highlight-css" href="ayu-highlight-3fdfc3ac.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="theme/extra-4e96a6d1.css">
        <link rel="stylesheet" href="theme/rss-button-d84d8455.css">
        <link rel="stylesheet" href="theme/css/catppuccin-mocha-code-21d34636.css">


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "coal";
            const default_dark_theme = "coal";
            window.path_to_searchindex_js = "searchindex-b1c0b0df.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc-ed34199c.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>‚Üê</kbd> or <kbd>‚Üí</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="mdbook-body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('coal')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="mdbook-sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("mdbook-sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="mdbook-sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="mdbook-sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="mdbook-page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="mdbook-menu-bar-hover-placeholder"></div>
                <div id="mdbook-menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="mdbook-sidebar-toggle" class="icon-button" for="mdbook-sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="mdbook-sidebar">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"/></svg></span>
                        </label>
                        <button id="mdbook-theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="mdbook-theme-list">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M371.3 367.1c27.3-3.9 51.9-19.4 67.2-42.9L600.2 74.1c12.6-19.5 9.4-45.3-7.6-61.2S549.7-4.4 531.1 9.6L294.4 187.2c-24 18-38.2 46.1-38.4 76.1L371.3 367.1zm-19.6 25.4l-116-104.4C175.9 290.3 128 339.6 128 400c0 3.9 .2 7.8 .6 11.6c1.8 17.5-10.2 36.4-27.8 36.4H96c-17.7 0-32 14.3-32 32s14.3 32 32 32H240c61.9 0 112-50.1 112-112c0-2.5-.1-5-.2-7.5z"/></svg></span>
                        </button>
                        <ul id="mdbook-theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-ayu">Ayu</button></li>
                        </ul>
                        <button id="mdbook-search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="mdbook-searchbar">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352c79.5 0 144-64.5 144-144s-64.5-144-144-144S64 128.5 64 208s64.5 144 144 144z"/></svg></span>
                        </button>
                    </div>

                    <h1 class="menu-title">nix-book</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <span class=fa-svg id="print-button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M128 0C92.7 0 64 28.7 64 64v96h64V64H354.7L384 93.3V160h64V93.3c0-17-6.7-33.3-18.7-45.3L400 18.7C388 6.7 371.7 0 354.7 0H128zM384 352v32 64H128V384 368 352H384zm64 32h32c17.7 0 32-14.3 32-32V256c0-35.3-28.7-64-64-64H64c-35.3 0-64 28.7-64 64v96c0 17.7 14.3 32 32 32H64v64c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V384zm-16-88c-13.3 0-24-10.7-24-24s10.7-24 24-24s24 10.7 24 24s-10.7 24-24 24z"/></svg></span>
                        </a>
                        <a href="https://github.com/saylesss88/nix-book.git" title="Git repository" aria-label="Git repository">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span>
                        </a>

                    </div>
                </div>

                <div id="mdbook-search-wrapper" class="hidden">
                    <form id="mdbook-searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="mdbook-searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="mdbook-searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <span class=fa-svg id="fa-spin"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M304 48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zm0 416c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM48 304c26.5 0 48-21.5 48-48s-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48zm464-48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM142.9 437c18.7-18.7 18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zm0-294.2c18.7-18.7 18.7-49.1 0-67.9S93.7 56.2 75 75s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zM369.1 437c18.7 18.7 49.1 18.7 67.9 0s18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9z"/></svg></span>
                            </div>
                        </div>
                    </form>
                    <div id="mdbook-searchresults-outer" class="searchresults-outer hidden">
                        <div id="mdbook-searchresults-header" class="searchresults-header"></div>
                        <ul id="mdbook-searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('mdbook-sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('mdbook-sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#mdbook-sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="mdbook-content" class="content">
                    <main>
                        <script>window.CONTENT_COLLECTIONS = {"collections":{"blog":[{"author":"saylesss88","collection":"blog","date":"2026-01-17T00:00:00+00:00","description":null,"draft":false,"path":"nix/encrypted_zfs.md","preview_html":"<p>I tested this on the libvirt stack with KVM, this should work on bare metal with\na few omissions.</p><p>This saves a ton of typing‚Ä¶</p><p>Boot the minimal ISO</p>","tags":["Virtual Machines","KVM","Impermanence","Encryption"],"title":"ZFS with LUKS and Impermanence"},{"author":"saylesss88","collection":"blog","date":"2026-01-16T00:00:00+00:00","description":null,"draft":false,"path":"nix/zfs_impermanence.md","preview_html":"<p>Yet another blog post inspired by\n<a href=\"https://grahamc.com/blog/erase-your-darlings/\">erase your darlings</a></p><p>I only tested this within a VM although with a few small tweaks it should work\non bare metal. I used the libvirtd stack with KVM for this.</p><p>NOTE: This example doesn‚Äôt use encryption, it would be easy to add ZFS Native\nEncryption by changing the first <code>zpool</code> command. It‚Äôs good enough for most\npeople but does leak some metadata. I‚Äôll add a LUKS example eventually which\nis more involved.</p>","tags":["Virtual Machines","KVM","Impermanence"],"title":"ZFS Impermanence in a VM"},{"author":"saylesss88","collection":"blog","date":"2026-01-15T00:00:00+00:00","description":null,"draft":false,"path":"nix/gpg-agent.md","preview_html":"<p>‚ö†Ô∏è <strong>SECURITY WARNING</strong>: This guide involves sensitive cryptographic material.\n<strong>Never share your private key or passphrase</strong>. Backup your keys and handle\nthem with extreme care.</p><p><img src=\"../images/gnupg.png\" alt=\"GnuPG\" /></p><p>The <a href=\"https://gpg.fail\">gpg.fail</a> is a write-up of real-world weaknesses in\nGPG/OpenPGP implementations and edge cases in the OpenPGP ecosystem‚Äînot the\nunderlying math of modern cryptography. ‚Äã The core idea is that signature\nverification needs two things: correct cryptography and confidence that the data\nyou think was verified is actually the same data the verifier processed, which\ncan break down when formats are complex and tooling is permissive or ambiguous.</p>","tags":["Encryption","GnuPG","security"],"title":"GnuPG gpg-agent"},{"author":"saylesss88","collection":"blog","date":"2026-01-13T00:00:00+00:00","description":null,"draft":false,"path":"nix/hardening_NixOS.md","preview_html":"<p><img src=\"../images/guy_fawks.png\" alt=\"guy fawks hacker\" /></p><p>Securing your NixOS system begins with a philosophy of minimalism, explicit\nconfiguration, and proactive control. As desktop Linux attracts more novice\nusers, it has become an increasingly valuable target for attackers. This makes\nit crucial to adopt security best practices early to protect your desktop from\ncommon attack vectors and to avoid configuration mistakes that could expose\nvulnerabilities.</p><p>‚ö†Ô∏è Warning: I am not a security expert. This guide presents various options\nfor hardening NixOS, but it is your responsibility to evaluate whether each\nadjustment suits your specific needs and environment. Security hardening and\nprocess isolation can introduce stability challenges, compatibility issues, or\nunexpected be","tags":["security","privacy","hardening"],"title":"Hardening NixOS"},{"author":"saylesss88","collection":"blog","date":"2026-01-11T00:00:00+00:00","description":null,"draft":false,"path":"nixos_containers.md","preview_html":"<p><img src=\"images/boxes.cleaned.png\" alt=\"boxes\" /></p><p>NixOS containers are lightweight <code>systemd-nspawn</code> containers managed\ndeclaratively through your NixOS configuration. They allow you to run separate,\nminimal NixOS instances on the same machine, each with its own services,\npackages, and (optionally) network stack.</p><p>‚ùó NixOS‚Äô containers do not provide full security out of the box (just like\ndocker). They do give you a separate chroot, but a privileged user (root) in a\ncontainer can escape the container and become root on the host system.\n‚Äì<a href=\"https://blog.beardhatcode.be/2020/12/Declarative-Nixos-Containers.html\">beardhatcode Declarative-Nixos-Containers</a></p>","tags":["nixos","containers"],"title":"NixOS Containers"},{"author":"saylesss88","collection":"blog","date":"2025-12-31T00:00:00+00:00","description":null,"draft":false,"path":"nixpkgs/rust_crate_to_nixpkgs.md","preview_html":"<p>NOTE: This example assumes you‚Äôre packaging a crate that‚Äôs already on\ncrates.io, or you‚Äôre packaging an existing Rust project for nixpkgs.</p><p>Nixpkgs is a big repository, so it helps to start with a focused workflow:\ncreate a branch, add a package under <code>pkgs/by-name/</code>, build it, then open a PR.</p><pre><code class=\"language-bash\">git clone git@github.com:your-user/nixpkgs.git\ncd nixpkgs\ngit remote add upstream git@github.com:NixOS/nixpkgs.git\n</code></pre>\n<p>(SSH avoids HTTPS helper issues)</p>","tags":["packaging","rust","nixpkgs"],"title":"Packaging a Rust crate for Nixpkgs"},{"author":"saylesss88","collection":"blog","date":"2025-12-25T00:00:00+00:00","description":null,"draft":false,"path":"nix/hardening_networking.md","preview_html":"<p>Since networks and systems vary, some adjustments may cause unexpected issues,\nespecially around critical components like DNS or firewalls. Always review and\ntest changes in a controlled environment before applying them broadly.</p><p>Understand the trade-offs and tailor the settings to your threat model and\nworkflow. Take what‚Äôs useful, adapt as needed, and seek expert guidance for\nmore advanced scenarios.</p><p>Every setup is unique, feel free to adapt or skip sections based on your needs.\nStart with the basics and build up as you gain confidence. The goal is\npractical, tested hardening tailored to you.</p>","tags":["hardening","networking","firewall"],"title":"Hardening Networking"},{"author":"saylesss88","collection":"blog","date":"2025-12-21T00:00:00+00:00","description":null,"draft":false,"path":"nix/browsing_security.md","preview_html":"<p>‚ÄúThe major problem with current systems is their inability to provide\neffective isolation between various programs running on one machine. E.g. if\nthe user‚Äôs Web browser gets compromised (due to a bug exploited by a malicious\nweb site), the OS is usually unable to protect other user‚Äôs applications and\ndata from also being compromised.‚Äù ‚ÄìQubes arch-spec</p><p>The web browser is the most complex, most exposed, and most vulnerable\napplication on a hardened Linux system. It is your primary interface with the\ninternet and, consequently, the primary vector for exploitation and tracking.</p><p>The <strong>Three Pillars of Web Defense</strong> To secure your browsing, you must balance\nthree often-conflicting goals:</p>","tags":["hardening","privacy","browsers"],"title":"Browsing Security"},{"author":"saylesss88","collection":"blog","date":"2025-12-08T00:00:00+00:00","description":"JJ Version Control","draft":false,"path":"vcs/jujutsu.md","preview_html":"<p><img src=\"../images/jujutsu.png\" alt=\"JJ Logo\" /></p><p>‚ö†Ô∏è <strong>Security Reminder</strong>: Never commit secrets (passwords, API keys, tokens,\netc.) in plain text to your Git repository. If you plan to publish your NixOS\nconfiguration, always use a secrets management tool like <code>sops-nix</code> or <code>agenix</code>\nto keep sensitive data safe. See the\n<a href=\"https://saylesss88.github.io/installation/enc/sops-nix.html\">Sops-Nix Guide</a>\nfor details.</p><p>Jujutsu (jj) is a modern, Git-compatible version control system designed to\nsimplify and improve the developer experience. It offers a new approach to\ndistributed version control, focusing on a more intuitive workflow, powerful\nundo capabilities, and a branchless model that reduces common pitfalls of Git.</p>","tags":["vcs","jj"],"title":"JJ VCS"},{"author":"saylesss88","collection":"blog","date":"2025-12-06T00:00:00+00:00","description":null,"draft":false,"path":"nix/encrypted_impermanence.md","preview_html":"<p>‚ùó Important Note: This guide details a setup involving encrypted partitions\nand impermanent NixOS. While powerful, such configurations require careful\nattention to detail. Incorrect steps, especially concerning encryption keys or\npersistent data paths, can lead to <strong>permanent data loss</strong>. Please read all\ninstructions thoroughly before proceeding and consider backing up any critical\ndata beforehand. This has only been tested with the disk layout described in\n<a href=\"https://saylesss88.github.io/installation/encrypted_manual.html\">Encrypted Setups</a></p><pre><code class=\"language-nix\"># flake.nix\n{\n  description = \"NixOS configuration\";\n\n  inputs = {\n    nixpkgs.url = \"github:nixos/nixpkgs/nixos-unstable\";\n    disko.url = \"github:nix-community/disko/latest\";\n    disko.input","tags":["impermanence","security"],"title":"Encrypted Impermanence"},{"author":"saylesss88","collection":"blog","date":"2025-12-06T00:00:00+00:00","description":null,"draft":false,"path":"nix/kvm.md","preview_html":"<p><img src=\"/images/steampunk5.cleaned.png\" alt=\"sp5\" /></p><p><strong>Host</strong> <code>secureblue</code> = Fedora Atomic with <strong>SELinux enforcing</strong>, <strong>sVirt</strong>,\n<strong>Secure Boot</strong>, and hardened defaults.</p><p><strong>Guest</strong>: NixOS in a VM ‚Üí full declarative power, near zero risk to host.</p>","tags":["KVM","Virtual Machines","secureblue"],"title":"KVM"},{"author":"saylesss88","collection":"blog","date":"2025-12-05T00:00:00+00:00","description":null,"draft":false,"path":"flakes/helix_flake_4.4.md","preview_html":"<p><img src=\"../images/helix.png\" alt=\"Helix Logo\" />‚Äì<a href=\"https://helix-editor.com/\">helix-editor.com</a></p><p>As we‚Äôve seen from previous examples, the helix editor repository includes a few\n<code>.nix</code> files including a <code>flake.nix</code>. Their flake uses a lot of idiomatic Nix\ncode and advanced features. First I will break down their <code>flake.nix</code> and\n<code>default.nix</code> to understand why they do certain things. And finally, we will\nchange the build to ‚Äúdebug‚Äù mode demonstrating how easily you can modify the\nbehavior of a package defined within a Nix flake without changing the original\nsource code or the upstream flake directly.</p><pre><code class=\"language-bash\">git clone https://github.com/helix-editor/helix.git\ncd helix\n</code></pre>\n<p>When you enter ","tags":["nixos","flakes","helix"],"title":"Understanding the Helix Flake"},{"author":"saylesss88","collection":"blog","date":"2025-12-04T00:00:00+00:00","description":null,"draft":false,"path":"nix/sops-nix.md","preview_html":"<p><a href=\"https://github.com/getsops/sops?ref=blog.gitguardian.com\">SOPS</a>, short for\n<strong>S</strong>ecrets<strong>OP</strong>eration<strong>S</strong>, is an editor of encrypted files that supports\nquite a few BINARY formats and encrypts with AWS KMS, GCP KMS, Azure Key Vault,\nage, and PGP.</p><p>Managing secrets‚Äîlike API keys, SSH deploy keys, and password hashes is a\ncritical part of system configuration, but it‚Äôs also one of the trickiest to do\nsecurely and reproducibly. Traditionally, secrets might be stored in ad hoc\nlocations, referenced by absolute paths, or managed manually outside of version\ncontrol. This approach makes it hard to share, rebuild, or audit your\nconfiguration, and increases the risk of accidental leaks or inconsistencies\nbetween systems.</p><p><code>sops-nix","tags":["secrets","sops-nix","hardening"],"title":"Sops-Nix"},{"author":"saylesss88","collection":"blog","date":"2025-11-30T00:00:00+00:00","description":null,"draft":false,"path":"intro_to_nushell_on_NixOS.md","preview_html":"<p><img src=\"images/nu.png\" alt=\"Nu\" /></p><p><strong>TL;DR</strong>:I recently switched default shells from zsh to nushell, this post is\nabout some of the challenges and advantages of using nushell with NixOS.</p><p>While the average user might not immediately see significant advantages, those\nwho frequently work with structured data formats like JSON, YAML, and CSV ‚Äì\nsuch as developers interacting with APIs, system administrators managing\nconfigurations, and data professionals ‚Äì will likely find Nushell‚Äôs native\ndata handling and powerful pipeline capabilities a plus. Additionally, users\nwho value a more consistent and safer scripting experience might appreciate\nNushell‚Äôs language-first design and features like strong typing.</p>","tags":["nushell","shells"],"title":"Intro to Nushell"},{"author":"saylesss88","collection":"blog","date":"2025-11-30T00:00:00+00:00","description":null,"draft":false,"path":"functions/functions_and_modules_2.2.md","preview_html":"<p>When you start exploring NixOS configurations or tools like Home Manager, you‚Äôll\nencounter a concept called Nix Modules. Modules are also functions, but they\nbehave differently regarding their arguments, which can be a source of\nconfusion.</p><p><strong>What are NixOS Modules</strong>?</p><p>Nix Modules are a powerful system built on top of basic Nix functions, primarily\nused for declarative system configurations (like NixOS, Home Manager, NixOps,\netc.). They allow you to define parts of your system configuration in separate\nfiles that are then composed together.</p>","tags":["nixos","functions"],"title":"Functions and NixOS Modules"},{"author":"saylesss88","collection":"blog","date":"2025-11-28T00:00:00+00:00","description":null,"draft":false,"path":"flakes/flake_outputs_4.2.md","preview_html":"<p>Flake outputs are what the flake produces when built. Flakes can have multiple\noutputs simultaneously such as:</p><p><strong>Packages</strong>: Self-contained bundles that are built using derivations and\nprovide either some kind of software or dependencies of software.</p><p><a href=\"https://saylesss88.github.io/NixOS_Modules_Explained_3.html\">NixOS modules</a></p>","tags":["nixos","flakes","outputs"],"title":"Flake outputs"},{"author":"saylesss88","collection":"blog","date":"2025-11-28T00:00:00+00:00","description":null,"draft":false,"path":"flakes/flake_inputs_4.1.md","preview_html":"<p>The attribute <code>inputs</code> specifies the dependencies of a flake, as an attrset\nmapping input names to flake references.</p><p>If a repository provides a <code>flake.nix</code> you can include it as an input in your\n<code>flake.nix</code>.</p><p>For example, I like yazi as my file explorer and have been using helix as my\neditor. To be able to get yazi to work with helix I needed the latest versions\nof both yazi and helix. One way to get the latest versions was to add their\nflakes as inputs to my flake:</p>","tags":["nixos","flakes"],"title":"Flake Inputs"},{"author":"saylesss88","collection":"blog","date":"2025-11-28T00:00:00+00:00","description":null,"draft":false,"path":"flakes/flake_examples_4.3.md","preview_html":"<p>This chapter provides practical examples to illustrate the concepts discussed in\n‚ÄúNix Flakes Explained.‚Äù</p><p>NixOS modules and configurations offer us a powerful and composable way to\ndefine and share system configurations. Imagine we have several independent\n‚Äúplayers,‚Äù each with their own unique set of configurations or modules. How do\nwe combine these individual contributions into a single, cohesive system without\ndirectly altering each player‚Äôs original flake?</p><p>This example demonstrates how flakes can extend and compose each other, allowing\nyou to layer configurations on top of existing ones. This is particularly useful\nwhen you want to:</p>","tags":["nixos","flakes"],"title":"Flake outputs"},{"author":"saylesss88","collection":"blog","date":"2025-11-27T00:00:00+00:00","description":null,"draft":false,"path":"Nix_Pull_Requests_11.md","preview_html":"<p><img src=\"images/gruv16.png\" alt=\"gruv16\" /></p><p><strong>Pull requests</strong> communicate changes to a branch in a repository. Once a pull\nrequest is opened, you can review changes with collaborators and add follow-up\ncommits.</p><p>A <strong>pull request</strong> is a proposal to merge a set of changes from one branch\ninto another. In a pull request, collaborators can review and discuss the\nproposed set of changes before they integrate the changes into the main\ncodebase.</p>","tags":["nixos","nixpkgs"],"title":"Nix Pull Requests"},{"author":"saylesss88","collection":"blog","date":"2025-11-24T00:00:00+00:00","description":null,"draft":false,"path":"installation/unenc/unenc_impermanence.md","preview_html":"<p>Figure 1: Impermanence Logo: Image of the Impermanence logo. Sourced from the</p><p><a href=\"https://github.com/nix-community/impermanence\">Impermanence repo</a></p><p>This guide is for an unencrypted setup, there are a few links at the end for\nencrypted setups. This guide follows the previous\n<a href=\"https://saylesss88.github.io/installation/unencrypted_setups.html\">minimal install guide</a>\nbut you should be able to adjust it carefully to meet your needs.</p>","tags":["nixos","btrfs","impermanence"],"title":"Unencrypted BTRFS Impermanence with Flakes"},{"author":"saylesss88","collection":"blog","date":"2025-11-22T00:00:00+00:00","description":null,"draft":false,"path":"functions/practical_functions_2.1.md","preview_html":"<p><img src=\"images/coding6.png\" alt=\"coding6\" /></p><p><a href=\"https://gitlab.com/api/v4/projects/4207231/packages/generic/graphviz-releases/2.49.3/graphviz-2.49.3.tar.gz\">graphviz</a></p><p><a href=\"https://ftp.gnu.org/gnu/hello/hello-2.12.1.tar.gz\">hello</a></p>","tags":["nixos","functions"],"title":"Practical Nix Functions"},{"author":"saylesss88","collection":"blog","date":"2025-11-22T00:00:00+00:00","description":null,"draft":false,"path":"flakes/overlays_4.5.md","preview_html":"<p><img src=\"../images/pokego.png\" alt=\"Pokego Logo\" />‚Äì<a href=\"https://github.com/rubiin/pokego\">pokego repo</a></p><p>Overlays are Nix functions that accept two arguments, <code>final</code> and <code>prev</code> and\nreturn a set of packages. Overlays are similar to <code>packageOverrides</code> as a way to\ncustomize Nixpkgs, <code>packageOverrides</code> acts as an overlay with only the <code>prev</code>\nargument. Therefore, <code>packageOverrides</code> is appropriate for basic use, but\noverlays are more powerful and easier to distribute.</p><p>Example:</p>","tags":["nixos","overlays","outputs"],"title":"Overlays"}],"notes":[{"author":"saylesss88","collection":"notes","date":"2025-12-05T00:00:00+00:00","description":null,"draft":false,"path":"nix/cachix_devour.md","preview_html":"<p>Using devour-flake to Cache All Your Flake Outputs to Cachix</p><p>When working with Nix flakes, it‚Äôs common to have many outputs: packages, apps,\ndev shells, NixOS or Darwin configurations, and more. Efficiently building and\ncaching all these outputs can be challenging, especially in CI or when\ncollaborating. This is where devour-flake and Cachix shine.</p><p><strong>Why Use the devour-flake?</strong></p>","tags":["cache","flakes"],"title":"Cachix devour-flake"},{"author":"saylesss88","collection":"notes","date":"2025-12-04T00:00:00+00:00","description":null,"draft":false,"path":"nix/whonix_kvm.md","preview_html":"<p><img src=\"../images/swappy-20250901-101339.cleaned.png\" alt=\"Whonix Logo\" /></p><p>‚ö†Ô∏è WARNING: There is no general software that can guarantee absolute anonymity\nor security; perfect security is a myth. Security is a continuous process, not\na one-time product. It also depends on time and resources: if an adversary has\nenough of either, eventual compromise is probable. However, by layering\ndefenses and following best practices, we can make attacks costly and\ntime-consuming, deterring all but highly targeted adversaries.</p><p>It is highly recommended to harden your Host Machine as Type 2 hypervisors are\nonly as secure as their host. KVM is actually a type 1 hypervisor but relies on\nQEMU for emulation which is a Type 2 hypervisor. This actually makes it a sort\nof hybrid in between Type 1 ","tags":["Virtual Machines","KVM","Whonix"],"title":"Whonix KVM on NixOS"},{"author":"saylesss88","collection":"notes","date":"2025-11-30T00:00:00+00:00","description":"Git","draft":false,"path":"vcs/git.md","preview_html":"<p>‚ö†Ô∏è <strong>Important</strong>: Never commit secrets (passwords, API keys, tokens, etc.) in\nplain text to your Git repository. If you plan to publish your NixOS\nconfiguration, always use a secrets management tool like sops-nix or agenix to\nkeep sensitive data safe. See the\n<a href=\"https://saylesss88.github.io/installation/enc/sops-nix.html\">Sops-Nix Guide</a>\nfor details.</p><p>It‚Äôs also important to understand that <strong>all files in the <code>/nix/store</code> are\nworld-readable by default</strong> This has important security implications for anyone\nmanaging sensitive data on a NixOS system.</p><p>What Does ‚ÄúWorld-Readable‚Äù Mean?</p>","tags":["vcs","git"],"title":"Git"},{"author":"saylesss88","collection":"notes","date":"2025-11-29T00:00:00+00:00","description":null,"draft":false,"path":"Intro_to_Nix_Derivations_7.md","preview_html":"<p><img src=\"images/gruv10.png\" alt=\"gruv10\" /></p><p>Nix‚Äôs build instructions, known as <strong>derivations</strong>, are defined using the Nix\nLanguage. These derivations can describe anything from individual software\npackages to complete system configurations. The Nix package manager then\ndeterministically ‚Äúrealizes‚Äù (builds) these derivations, ensuring consistency\nbecause they rely solely on a predefined set of inputs.</p><p>Most things in NixOS are built around derivations. Your NixOS system is\ndescribed by such a single system derivation. When you want to apply a new\nconfiguration, <code>nixos-rebuild</code> handles the process:</p>","tags":["notes","derivations"],"title":"Intro to Derivations"},{"author":"saylesss88","collection":"notes","date":"2025-11-22T00:00:00+00:00","description":null,"draft":false,"path":"nixpkgs/fork_clone_contribute.md","preview_html":"<p>In the <a href=\"https://github.com/NixOS/nixpkgs\">Nixpkgs</a> Repository.</p><p>Click Fork, then Create a new Fork.</p><p>Uncheck the box ‚ÄúOnly fork the <code>master</code> branch‚Äù, for development we will need\nmore branches.</p>","tags":["git","vcs","nixpkgs"],"title":"Fork, Clone, Contribute"},{"author":"saylesss88","collection":"notes","date":"2025-11-22T00:00:00+00:00","description":null,"draft":false,"path":"nix/impermanence.md","preview_html":"<p>Figure 1: <strong>Impermanence Logo</strong>: Image of the Impermanence logo. Sourced from\nthe</p><p><a href=\"https://github.com/nix-community/impermanence\">Impermanence repo</a></p><p><img src=\"../images/Impermanence.png\" alt=\"Impermanence Logo\" /></p>","tags":["impermanence","security"],"title":"Unencrypted Impermanence"}],"posts":[{"author":null,"collection":null,"date":"2026-01-04T19:05:54.846247871+00:00","description":"\n","draft":false,"path":"index.md","preview_html":"","tags":[],"title":"index"},{"author":"saylesss88","collection":null,"date":"2025-11-22T00:00:00+00:00","description":null,"draft":false,"path":"nixpkgs/overlay.md","preview_html":"<p>The following is done with a local clone of Nixpkgs located at <code>~/src/nixpkgs</code>.</p><p>In this example, we will create an overlay to override the version of\n<code>btrfs-progs</code>. In the root directory of our local clone of Nixpkgs\n(i.e.<code>~/src/nixpkgs</code>) we can run the following command to locate <code>btrfs-progs</code>\nwithin Nixpkgs:</p><pre><code class=\"language-bash\">fd 'btrfs-progs' .\n./pkgs/by-name/bt/btrfs-progs/\n</code></pre>\n<p>Open the <code>package.nix</code> in the above directory and copy the <code>src</code> block within\nthe <code>stdenv.mkDerivation</code> block like so:</p>","tags":[],"title":"Nixpkgs Overlays"},{"author":"saylesss88","collection":null,"date":"2025-11-22T00:00:00+00:00","description":null,"draft":false,"path":"nixpkgs/local_package.md","preview_html":"<p>This chapter demonstrates the fundamental pattern for creating a package. Every\npackage recipe is a file that declares a function. This function takes the\npackages dependencies as argument.</p><p>In this example we‚Äôll make a simple package with <code>coreutils</code> and build it.\nDemonstrating the process of building and testing a local package.</p><p>This chapter will assume you have already have a cloned fork of Nixpkgs. I\nchoose to clone mine to the <code>~/src/</code> directory.</p>","tags":[],"title":"Local Nixpkgs"},{"author":"saylesss88","collection":null,"date":"2025-11-22T00:00:00+00:00","description":null,"draft":false,"path":"nix/nix_package_manager.md","preview_html":"<p>Nix is a <em>purely functional package manager</em>. This means that it treats packages\nlike values in purely functional programming languages ‚Äì they are built by\nfunctions that don‚Äôt have side-effects, and they never change after they have\nbeen built.</p><p>Nix stores packages in the <em>Nix store</em>, usually the directory <code>/nix/store</code>,\nwhere each package has its own unique subdirectory such as:</p><pre><code class=\"language-bash\">/nix/store/y53c0lamag5wpx7vsiv7wmnjdgq97yd6-yazi-25.5.14pre20250526_74a8ea9\n</code></pre>\n<p>You can use the Nix on most Linux distributions and Mac OS also has good support\nfor Nix. It should work on most platforms that support POSIX threads and have a\nC++11 compiler.</p>","tags":[],"title":"Nix Package Manager"},{"author":"saylesss88","collection":null,"date":"2025-11-22T00:00:00+00:00","description":null,"draft":false,"path":"nix/nix_language.md","preview_html":"<p>The Nix language is designed for conveniently creating and composing\n<em>derivations</em> precise descriptions of how contents of files are used to derive\nnew files. ‚Äì<a href=\"https://nix.dev/manual/nix/2.28/language/\">Nix Reference Manual</a></p><p>Nix is often described as ‚ÄúJSON with functions.‚Äù It‚Äôs a declarative language\nwhere you define outcomes, not step-by-step instructions. Instead of writing\nsequential code, you create expressions that describe data structures,\nfunctions, and dependencies. These expressions are evaluated lazily, meaning Nix\ncomputes values only when needed, making it efficient for managing large\nsystems.</p><p>You can plug most of the following into the <code>nix repl</code> I‚Äôm showing it in a\nsingle code block here for brevity:</p>","tags":[],"title":"Nix Lang"},{"author":"saylesss88","collection":null,"date":"2025-11-22T00:00:00+00:00","description":null,"draft":false,"path":"nix/nixLang/nix_paths.md","preview_html":"<p>The following examples are done with a local <code>nixpkgs</code> clone located at\n<code>~/src/nixpkgs</code></p><p>Paths in Nix always need a <code>/</code> in them and always expand to absolute paths\nrelative to your current directory.</p><pre><code class=\"language-bash\">nix repl\nnix-repl&gt; ./.\n/home/jr/src/nixpkgs\nnix-repl&gt; ./. + \"/lib\"\n/home/jr/src/nixpkgs/lib\n</code></pre>\n<p>Nix does <em>path normalization</em> every time you append strings, so if you just add\na slash <code>/</code> its not actually there:</p>","tags":[],"title":"Nix Paths"},{"author":"saylesss88","collection":null,"date":"2025-11-22T00:00:00+00:00","description":null,"draft":false,"path":"nix/README.md","preview_html":"<p>üìå <strong>How to Use This Guide</strong></p><p><strong>Read warnings</strong>: Advanced hardening can break compatibility or cause data\nloss! Pause and research before enabling anything not listed above unless you\nunderstand the consequences.</p><p><strong>Hardening NixOS</strong>:</p>","tags":[],"title":"Readme1"},{"author":"saylesss88","collection":null,"date":"2025-11-22T00:00:00+00:00","description":null,"draft":false,"path":"installation/unenc/unencrypted_setups.md","preview_html":"<p>Figure 1: BTRFS Logo: Image of the BTRFS logo. Sourced from the BTRFS repo BTRFS\nlogo</p><p>Why I Chose BTRFS I chose BTRFS because I was already familiar with it from\nusing it with Arch Linux and I found it to be very easy to use. From what I‚Äôve\nread, there are licensing issues between the Linux Kernel and ZFS which means\nthat ZFS is not part of the Linux Kernel; it‚Äôs maintained by the OpenZFS project\nand available as a separate kernel module. This can cause issues and make you\nthink more about your filesystem than I personally want to at this point.</p><p>A <strong>Btrfs subvolume</strong> is essentially a distinct section within a Btrfs\nfilesystem that maintains its own set of files and directories, along with a\nseparate inode numbering system. Unlike block-level partitions (such as ","tags":[],"title":"Unencrypted Install"},{"author":"saylesss88","collection":null,"date":"2025-11-22T00:00:00+00:00","description":null,"draft":false,"path":"installation/enc/encrypted_impermanence.md","preview_html":"<p>‚ùó Important Note: This guide details a setup involving encrypted partitions\nand impermanent NixOS. While powerful, such configurations require careful\nattention to detail. Incorrect steps, especially concerning encryption keys or\npersistent data paths, can lead to <strong>permanent data loss</strong>. Please read all\ninstructions thoroughly before proceeding and consider backing up any critical\ndata beforehand. This has only been tested with the disk layout described in\n<a href=\"https://saylesss88.github.io/installation/encrypted_manual.html\">Encrypted Setups</a></p><p>As a system operates, it gradually accumulates state on its root partition. This\nstate is stored in various directories such as <code>/etc</code> and <code>/var</code>, capturing all\nthe configuration changes, logs, and o","tags":[],"title":"Encrypted Impermanence"},{"author":"saylesss88","collection":null,"date":"2025-11-22T00:00:00+00:00","description":null,"draft":false,"path":"installation/enc/sops-nix.md","preview_html":"<p><a href=\"https://github.com/getsops/sops?ref=blog.gitguardian.com\">SOPS</a>, short for\n<strong>S</strong>ecrets<strong>OP</strong>eration<strong>S</strong>, is an editor of encrypted files that supports\nquite a few BINARY formats and encrypts with AWS KMS, GCP KMS, Azure Key Vault,\nage, and PGP.</p><p>Managing secrets‚Äîlike API keys, SSH deploy keys, and password hashes is a\ncritical part of system configuration, but it‚Äôs also one of the trickiest to do\nsecurely and reproducibly. Traditionally, secrets might be stored in ad hoc\nlocations, referenced by absolute paths, or managed manually outside of version\ncontrol. This approach makes it hard to share, rebuild, or audit your\nconfiguration, and increases the risk of accidental leaks or inconsistencies\nbetween systems.</p><p><code>sops-nix","tags":[],"title":"Sops-Nix"},{"author":"saylesss88","collection":null,"date":"2025-11-22T00:00:00+00:00","description":null,"draft":false,"path":"installation/enc/lanzaboote.md","preview_html":"<p>‚ö†Ô∏è <strong>Warning: This can easily brick your system</strong> ‚ö†Ô∏è</p><p>We will mainly follow the lanzaboote\n<a href=\"https://github.com/nix-community/lanzaboote/blob/master/docs/QUICK_START.md\">Quick Start Guide</a></p><p>For Windows dual-booters and BitLocker users, you should export your BitLocker\nrecovery keys and confirm that they are correct. Refer to this\n<a href=\"https://support.microsoft.com/en-us/windows/find-your-bitlocker-recovery-key-6b71ad27-0b89-ea08-f143-056f5ab347d6\">Microsoft support article</a></p>","tags":[],"title":"Lanzaboote"},{"author":"saylesss88","collection":null,"date":"2025-11-22T00:00:00+00:00","description":null,"draft":false,"path":"installation/enc/enc_install.md","preview_html":"<p>NixOS supports file systems that are encrypted using LUKS (Linux Unified Key\nSetup). This guide walks you through an encrypted NixOS installation using Disko\nfor disk management and Btrfs for subvolumes. It is designed for users who want\nfull disk encryption and a modern filesystem layout. If you prefer an\nunencrypted setup, you can skip the LUKS and encryption steps, but this guide\nfocuses on security and flexibility.</p><p>If you choose to set up impermanence, ensure it matches your install. Encrypted\nSetup with Encrypted Impermanence and Unencrypted Setup with Unencrypted\nImpermanence.</p><p>‚ùó NOTE: This is a bit convoluted, there are a few paths you can follow. If\nyou choose to use the starter repo (<a href=\"https://github.com/saylesss88/my-flake\">https://github.com/saylesss88/my-fl","tags":[],"title":"Encrypted Install"},{"author":"saylesss88","collection":null,"date":"2025-11-22T00:00:00+00:00","description":null,"draft":false,"path":"installation/enc/USB_keyfile.md","preview_html":"<p>This allows you to use a USB stick for your keyfile, with a backup in case you\nwant or need it. There is a setting <code>fallbackToPassword</code> that protects you in\ncase something fails with the USB key.</p><p>First, I‚Äôll show how to set up a dedicated USB stick for a keyfile. (i.e., one\nthat is only used for this). After that I will show the process of adding the\nkeyfile to a USB stick with existing data on it that you don‚Äôt want to lose.</p><p><strong>Generate the keyfile</strong></p>","tags":[],"title":"USB Keyfile"},{"author":"saylesss88","collection":null,"date":"2025-11-22T00:00:00+00:00","description":null,"draft":false,"path":"installation/README.md","preview_html":"<p>This section provides detailed guides for installing NixOS. You‚Äôll choose\nbetween an <strong>unencrypted</strong> or <strong>encrypted</strong> base setup. After your core\ninstallation, you can explore adding optional features like <code>sops</code> for encrypted\nsecrets, <code>lanzaboote</code> for Secure Boot, or <code>impermanence</code> for a stateless system.</p><p><strong>Guide:</strong>\n<a href=\"https://saylesss88.github.io/installation/unenc/unencrypted_setups.html\">Minimal Btrfs-Subvol Install with Disko and Flakes</a></p><p><strong>Best for:</strong></p>","tags":[],"title":"My Chapter"},{"author":"saylesss88","collection":null,"date":"2025-11-22T00:00:00+00:00","description":null,"draft":false,"path":"Working_with_Nixpkgs_Locally_10.md","preview_html":"<p><img src=\"images/server_rack.cleaned.png\" alt=\"server_rack\" /></p><p>Nixpkgs, the package repository for NixOS, is a powerful resource for building\nand customizing software.</p><p>Working with a local copy enhances development, debugging, and contribution\nworkflows.</p>","tags":[],"title":"Local Nixpkgs"},{"author":"saylesss88","collection":null,"date":"2025-11-22T00:00:00+00:00","description":null,"draft":false,"path":"Debugging_and_Tracing_NixOS_Modules_9.md","preview_html":"<p>This chapter covers debugging NixOS modules, focusing on tracing module options\nand evaluating merges.</p><p><img src=\"images/coding4.png\" alt=\"404\" /></p><p><a href=\"https://saylesss88.github.io/posts/nix_modules_explained/\">nix-modules-explained</a></p>","tags":[],"title":"Debugging NixOS modules"},{"author":"saylesss88","collection":null,"date":"2025-11-22T00:00:00+00:00","description":null,"draft":false,"path":"Comparing_Flakes_and_Traditional_Nix_8.md","preview_html":"<p>A key benefit of Nix Flakes is their <em>default</em> enforcement of <strong>pure\nevaluation</strong>.</p><p>In Nix, an <strong>impure operation</strong> depends on something <em>outside</em> its explicit\ninputs. Examples include:</p><p>Impurity leads to unpredictable builds that may differ across systems or time.</p>","tags":[],"title":"Comparing Flakes and Traditional Nix"},{"author":"saylesss88","collection":null,"date":"2025-11-21T00:00:00+00:00","description":null,"draft":false,"path":"Understanding_Top-Level_Attributes_5.md","preview_html":"<p>This explanation is based on insights from Infinisil, a prominent figure in the\nNix community, to help clarify the concept of top-level attributes within NixOS\nmodules.</p><p>In a NixOS system, everything is built from a single ‚Äúsystem derivation.‚Äù The\ncommand <code>nix-build '&lt;nixpkgs/nixos&gt;' -A system</code> initiates this build process.</p><p>The <code>-A system</code> part tells Nix to focus on the <code>system</code> attribute defined in the\n<code>'&lt;nixpkgs/nixos&gt;'</code> file (which is essentially <code>./default.nix</code> within the\nNixpkgs repository).</p>","tags":[],"title":"Top-Level Attributes"},{"author":"saylesss88","collection":null,"date":"2025-11-21T00:00:00+00:00","description":null,"draft":false,"path":"Understanding_Nix_Functions_2.md","preview_html":"<p><img src=\"images/trees2.cleaned.png\" alt=\"trees2\" /></p><p><strong>Functions</strong> are the building blocks of Nix, appearing everywhere in Nix\nexpressions and configurations. Mastering them is essential for writing\neffective Nix code and understanding tools like NixOS and Home Manager. This\nchapter explores how Nix functions work, focusing on their <strong>single-argument\nnature</strong>, <strong>currying</strong>, <strong>partial application</strong>, and their role in <strong>modules</strong>.</p><p>A <strong>Nix Function</strong> is a rule that takes an input (called an <strong>argument</strong>) and\nproduces an <strong>output</strong> based on that input. Unlike many programming languages,\nNix functions are designed to take exactly one argument at a time. This unique\napproach, co","tags":[],"title":"Understanding Nix Functions"},{"author":"saylesss88","collection":null,"date":"2025-11-21T00:00:00+00:00","description":null,"draft":false,"path":"Package_Definitions_Explained_6.md","preview_html":"<p><img src=\"images/coding2.png\" alt=\"coding2\" /></p><p>In Nix, the concept of a <strong>package</strong> can refer to two things:</p><p>A collection of files and data that constitute a piece of software or an\nartifact.</p>","tags":[],"title":"Package Definitions Explained"},{"author":"saylesss88","collection":null,"date":"2025-11-21T00:00:00+00:00","description":null,"draft":false,"path":"Nix_Flakes_Explained_4.md","preview_html":"<p><img src=\"images/trees3.cleaned.png\" alt=\"trees3\" /></p><p>If you‚Äôre completely new, take a look at\n<a href=\"https://nixos.wiki/wiki/flakes#Installing_flakes\">this</a> to get flakes on your\nsystem.</p><p>For the Nix Flake man page type <code>man nix3 flake</code> and for a specific feature,\ntype something like <code>man nix3 flake-lock</code>.</p>","tags":[],"title":"Nix Flakes Explained"},{"author":"saylesss88","collection":null,"date":"2025-11-21T00:00:00+00:00","description":null,"draft":false,"path":"NixOS_Modules_Explained_3.md","preview_html":"<p><img src=\"images/buildings1.png\" alt=\"buildings\" /></p><p><strong>TL;DR</strong>: In this chapter, we will break down the Nix module system used by\nboth NixOS and Home-Manager. We will discuss using home-manager as a module and\nthe flexibility that modules give us. We will touch on options and break down\nthe <code>vim</code> module from the Nixpkgs collection. Finally we will display how to\ntest modules with the repl.</p><p>Your <code>configuration.nix</code> is a module. For the Nixpkgs collection most modules\nare in <code>nixos/modules</code>.</p>","tags":[],"title":"Nix Module System Explained"},{"author":"saylesss88","collection":null,"date":"2025-11-21T00:00:00+00:00","description":null,"draft":false,"path":"Getting_Started_with_Nix_1.md","preview_html":"<p><img src=\"images/trees1.cleaned.png\" alt=\"trees\" /></p><p>Welcome to <em>nix-book</em>, an introductory book about Nix. This book leans more\ntowards using Flakes but will contrast traditional Nix where beneficial.\nOriginally, this content started as a blog. I‚Äôm refining its flow to make it\nmore cohesive.</p><p>In this chapter, I will touch on the different parts of the Nix ecosystem, give\na quick example of each and explain how they fit together.</p>","tags":[],"title":"Intro to Nix"}]},"entries":[{"author":"saylesss88","collection":"blog","date":"2026-01-17T00:00:00+00:00","description":null,"draft":false,"path":"nix/encrypted_zfs.md","preview_html":"<p>I tested this on the libvirt stack with KVM, this should work on bare metal with\na few omissions.</p><p>This saves a ton of typing‚Ä¶</p><p>Boot the minimal ISO</p>","tags":["Virtual Machines","KVM","Impermanence","Encryption"],"title":"ZFS with LUKS and Impermanence"},{"author":"saylesss88","collection":"blog","date":"2026-01-16T00:00:00+00:00","description":null,"draft":false,"path":"nix/zfs_impermanence.md","preview_html":"<p>Yet another blog post inspired by\n<a href=\"https://grahamc.com/blog/erase-your-darlings/\">erase your darlings</a></p><p>I only tested this within a VM although with a few small tweaks it should work\non bare metal. I used the libvirtd stack with KVM for this.</p><p>NOTE: This example doesn‚Äôt use encryption, it would be easy to add ZFS Native\nEncryption by changing the first <code>zpool</code> command. It‚Äôs good enough for most\npeople but does leak some metadata. I‚Äôll add a LUKS example eventually which\nis more involved.</p>","tags":["Virtual Machines","KVM","Impermanence"],"title":"ZFS Impermanence in a VM"},{"author":"saylesss88","collection":"blog","date":"2026-01-15T00:00:00+00:00","description":null,"draft":false,"path":"nix/gpg-agent.md","preview_html":"<p>‚ö†Ô∏è <strong>SECURITY WARNING</strong>: This guide involves sensitive cryptographic material.\n<strong>Never share your private key or passphrase</strong>. Backup your keys and handle\nthem with extreme care.</p><p><img src=\"../images/gnupg.png\" alt=\"GnuPG\" /></p><p>The <a href=\"https://gpg.fail\">gpg.fail</a> is a write-up of real-world weaknesses in\nGPG/OpenPGP implementations and edge cases in the OpenPGP ecosystem‚Äînot the\nunderlying math of modern cryptography. ‚Äã The core idea is that signature\nverification needs two things: correct cryptography and confidence that the data\nyou think was verified is actually the same data the verifier processed, which\ncan break down when formats are complex and tooling is permissive or ambiguous.</p>","tags":["Encryption","GnuPG","security"],"title":"GnuPG gpg-agent"},{"author":"saylesss88","collection":"blog","date":"2026-01-13T00:00:00+00:00","description":null,"draft":false,"path":"nix/hardening_NixOS.md","preview_html":"<p><img src=\"../images/guy_fawks.png\" alt=\"guy fawks hacker\" /></p><p>Securing your NixOS system begins with a philosophy of minimalism, explicit\nconfiguration, and proactive control. As desktop Linux attracts more novice\nusers, it has become an increasingly valuable target for attackers. This makes\nit crucial to adopt security best practices early to protect your desktop from\ncommon attack vectors and to avoid configuration mistakes that could expose\nvulnerabilities.</p><p>‚ö†Ô∏è Warning: I am not a security expert. This guide presents various options\nfor hardening NixOS, but it is your responsibility to evaluate whether each\nadjustment suits your specific needs and environment. Security hardening and\nprocess isolation can introduce stability challenges, compatibility issues, or\nunexpected be","tags":["security","privacy","hardening"],"title":"Hardening NixOS"},{"author":"saylesss88","collection":"blog","date":"2026-01-11T00:00:00+00:00","description":null,"draft":false,"path":"nixos_containers.md","preview_html":"<p><img src=\"images/boxes.cleaned.png\" alt=\"boxes\" /></p><p>NixOS containers are lightweight <code>systemd-nspawn</code> containers managed\ndeclaratively through your NixOS configuration. They allow you to run separate,\nminimal NixOS instances on the same machine, each with its own services,\npackages, and (optionally) network stack.</p><p>‚ùó NixOS‚Äô containers do not provide full security out of the box (just like\ndocker). They do give you a separate chroot, but a privileged user (root) in a\ncontainer can escape the container and become root on the host system.\n‚Äì<a href=\"https://blog.beardhatcode.be/2020/12/Declarative-Nixos-Containers.html\">beardhatcode Declarative-Nixos-Containers</a></p>","tags":["nixos","containers"],"title":"NixOS Containers"},{"author":null,"collection":null,"date":"2026-01-04T19:05:54.846247871+00:00","description":"\n","draft":false,"path":"index.md","preview_html":"","tags":[],"title":"index"},{"author":"saylesss88","collection":"blog","date":"2025-12-31T00:00:00+00:00","description":null,"draft":false,"path":"nixpkgs/rust_crate_to_nixpkgs.md","preview_html":"<p>NOTE: This example assumes you‚Äôre packaging a crate that‚Äôs already on\ncrates.io, or you‚Äôre packaging an existing Rust project for nixpkgs.</p><p>Nixpkgs is a big repository, so it helps to start with a focused workflow:\ncreate a branch, add a package under <code>pkgs/by-name/</code>, build it, then open a PR.</p><pre><code class=\"language-bash\">git clone git@github.com:your-user/nixpkgs.git\ncd nixpkgs\ngit remote add upstream git@github.com:NixOS/nixpkgs.git\n</code></pre>\n<p>(SSH avoids HTTPS helper issues)</p>","tags":["packaging","rust","nixpkgs"],"title":"Packaging a Rust crate for Nixpkgs"},{"author":"saylesss88","collection":"blog","date":"2025-12-25T00:00:00+00:00","description":null,"draft":false,"path":"nix/hardening_networking.md","preview_html":"<p>Since networks and systems vary, some adjustments may cause unexpected issues,\nespecially around critical components like DNS or firewalls. Always review and\ntest changes in a controlled environment before applying them broadly.</p><p>Understand the trade-offs and tailor the settings to your threat model and\nworkflow. Take what‚Äôs useful, adapt as needed, and seek expert guidance for\nmore advanced scenarios.</p><p>Every setup is unique, feel free to adapt or skip sections based on your needs.\nStart with the basics and build up as you gain confidence. The goal is\npractical, tested hardening tailored to you.</p>","tags":["hardening","networking","firewall"],"title":"Hardening Networking"},{"author":"saylesss88","collection":"blog","date":"2025-12-21T00:00:00+00:00","description":null,"draft":false,"path":"nix/browsing_security.md","preview_html":"<p>‚ÄúThe major problem with current systems is their inability to provide\neffective isolation between various programs running on one machine. E.g. if\nthe user‚Äôs Web browser gets compromised (due to a bug exploited by a malicious\nweb site), the OS is usually unable to protect other user‚Äôs applications and\ndata from also being compromised.‚Äù ‚ÄìQubes arch-spec</p><p>The web browser is the most complex, most exposed, and most vulnerable\napplication on a hardened Linux system. It is your primary interface with the\ninternet and, consequently, the primary vector for exploitation and tracking.</p><p>The <strong>Three Pillars of Web Defense</strong> To secure your browsing, you must balance\nthree often-conflicting goals:</p>","tags":["hardening","privacy","browsers"],"title":"Browsing Security"},{"author":"saylesss88","collection":"blog","date":"2025-12-08T00:00:00+00:00","description":"JJ Version Control","draft":false,"path":"vcs/jujutsu.md","preview_html":"<p><img src=\"../images/jujutsu.png\" alt=\"JJ Logo\" /></p><p>‚ö†Ô∏è <strong>Security Reminder</strong>: Never commit secrets (passwords, API keys, tokens,\netc.) in plain text to your Git repository. If you plan to publish your NixOS\nconfiguration, always use a secrets management tool like <code>sops-nix</code> or <code>agenix</code>\nto keep sensitive data safe. See the\n<a href=\"https://saylesss88.github.io/installation/enc/sops-nix.html\">Sops-Nix Guide</a>\nfor details.</p><p>Jujutsu (jj) is a modern, Git-compatible version control system designed to\nsimplify and improve the developer experience. It offers a new approach to\ndistributed version control, focusing on a more intuitive workflow, powerful\nundo capabilities, and a branchless model that reduces common pitfalls of Git.</p>","tags":["vcs","jj"],"title":"JJ VCS"},{"author":"saylesss88","collection":"blog","date":"2025-12-06T00:00:00+00:00","description":null,"draft":false,"path":"nix/encrypted_impermanence.md","preview_html":"<p>‚ùó Important Note: This guide details a setup involving encrypted partitions\nand impermanent NixOS. While powerful, such configurations require careful\nattention to detail. Incorrect steps, especially concerning encryption keys or\npersistent data paths, can lead to <strong>permanent data loss</strong>. Please read all\ninstructions thoroughly before proceeding and consider backing up any critical\ndata beforehand. This has only been tested with the disk layout described in\n<a href=\"https://saylesss88.github.io/installation/encrypted_manual.html\">Encrypted Setups</a></p><pre><code class=\"language-nix\"># flake.nix\n{\n  description = \"NixOS configuration\";\n\n  inputs = {\n    nixpkgs.url = \"github:nixos/nixpkgs/nixos-unstable\";\n    disko.url = \"github:nix-community/disko/latest\";\n    disko.input","tags":["impermanence","security"],"title":"Encrypted Impermanence"},{"author":"saylesss88","collection":"blog","date":"2025-12-06T00:00:00+00:00","description":null,"draft":false,"path":"nix/kvm.md","preview_html":"<p><img src=\"/images/steampunk5.cleaned.png\" alt=\"sp5\" /></p><p><strong>Host</strong> <code>secureblue</code> = Fedora Atomic with <strong>SELinux enforcing</strong>, <strong>sVirt</strong>,\n<strong>Secure Boot</strong>, and hardened defaults.</p><p><strong>Guest</strong>: NixOS in a VM ‚Üí full declarative power, near zero risk to host.</p>","tags":["KVM","Virtual Machines","secureblue"],"title":"KVM"},{"author":"saylesss88","collection":"notes","date":"2025-12-05T00:00:00+00:00","description":null,"draft":false,"path":"nix/cachix_devour.md","preview_html":"<p>Using devour-flake to Cache All Your Flake Outputs to Cachix</p><p>When working with Nix flakes, it‚Äôs common to have many outputs: packages, apps,\ndev shells, NixOS or Darwin configurations, and more. Efficiently building and\ncaching all these outputs can be challenging, especially in CI or when\ncollaborating. This is where devour-flake and Cachix shine.</p><p><strong>Why Use the devour-flake?</strong></p>","tags":["cache","flakes"],"title":"Cachix devour-flake"},{"author":"saylesss88","collection":"blog","date":"2025-12-05T00:00:00+00:00","description":null,"draft":false,"path":"flakes/helix_flake_4.4.md","preview_html":"<p><img src=\"../images/helix.png\" alt=\"Helix Logo\" />‚Äì<a href=\"https://helix-editor.com/\">helix-editor.com</a></p><p>As we‚Äôve seen from previous examples, the helix editor repository includes a few\n<code>.nix</code> files including a <code>flake.nix</code>. Their flake uses a lot of idiomatic Nix\ncode and advanced features. First I will break down their <code>flake.nix</code> and\n<code>default.nix</code> to understand why they do certain things. And finally, we will\nchange the build to ‚Äúdebug‚Äù mode demonstrating how easily you can modify the\nbehavior of a package defined within a Nix flake without changing the original\nsource code or the upstream flake directly.</p><pre><code class=\"language-bash\">git clone https://github.com/helix-editor/helix.git\ncd helix\n</code></pre>\n<p>When you enter ","tags":["nixos","flakes","helix"],"title":"Understanding the Helix Flake"},{"author":"saylesss88","collection":"notes","date":"2025-12-04T00:00:00+00:00","description":null,"draft":false,"path":"nix/whonix_kvm.md","preview_html":"<p><img src=\"../images/swappy-20250901-101339.cleaned.png\" alt=\"Whonix Logo\" /></p><p>‚ö†Ô∏è WARNING: There is no general software that can guarantee absolute anonymity\nor security; perfect security is a myth. Security is a continuous process, not\na one-time product. It also depends on time and resources: if an adversary has\nenough of either, eventual compromise is probable. However, by layering\ndefenses and following best practices, we can make attacks costly and\ntime-consuming, deterring all but highly targeted adversaries.</p><p>It is highly recommended to harden your Host Machine as Type 2 hypervisors are\nonly as secure as their host. KVM is actually a type 1 hypervisor but relies on\nQEMU for emulation which is a Type 2 hypervisor. This actually makes it a sort\nof hybrid in between Type 1 ","tags":["Virtual Machines","KVM","Whonix"],"title":"Whonix KVM on NixOS"},{"author":"saylesss88","collection":"blog","date":"2025-12-04T00:00:00+00:00","description":null,"draft":false,"path":"nix/sops-nix.md","preview_html":"<p><a href=\"https://github.com/getsops/sops?ref=blog.gitguardian.com\">SOPS</a>, short for\n<strong>S</strong>ecrets<strong>OP</strong>eration<strong>S</strong>, is an editor of encrypted files that supports\nquite a few BINARY formats and encrypts with AWS KMS, GCP KMS, Azure Key Vault,\nage, and PGP.</p><p>Managing secrets‚Äîlike API keys, SSH deploy keys, and password hashes is a\ncritical part of system configuration, but it‚Äôs also one of the trickiest to do\nsecurely and reproducibly. Traditionally, secrets might be stored in ad hoc\nlocations, referenced by absolute paths, or managed manually outside of version\ncontrol. This approach makes it hard to share, rebuild, or audit your\nconfiguration, and increases the risk of accidental leaks or inconsistencies\nbetween systems.</p><p><code>sops-nix","tags":["secrets","sops-nix","hardening"],"title":"Sops-Nix"},{"author":"saylesss88","collection":"notes","date":"2025-11-30T00:00:00+00:00","description":"Git","draft":false,"path":"vcs/git.md","preview_html":"<p>‚ö†Ô∏è <strong>Important</strong>: Never commit secrets (passwords, API keys, tokens, etc.) in\nplain text to your Git repository. If you plan to publish your NixOS\nconfiguration, always use a secrets management tool like sops-nix or agenix to\nkeep sensitive data safe. See the\n<a href=\"https://saylesss88.github.io/installation/enc/sops-nix.html\">Sops-Nix Guide</a>\nfor details.</p><p>It‚Äôs also important to understand that <strong>all files in the <code>/nix/store</code> are\nworld-readable by default</strong> This has important security implications for anyone\nmanaging sensitive data on a NixOS system.</p><p>What Does ‚ÄúWorld-Readable‚Äù Mean?</p>","tags":["vcs","git"],"title":"Git"},{"author":"saylesss88","collection":"blog","date":"2025-11-30T00:00:00+00:00","description":null,"draft":false,"path":"intro_to_nushell_on_NixOS.md","preview_html":"<p><img src=\"images/nu.png\" alt=\"Nu\" /></p><p><strong>TL;DR</strong>:I recently switched default shells from zsh to nushell, this post is\nabout some of the challenges and advantages of using nushell with NixOS.</p><p>While the average user might not immediately see significant advantages, those\nwho frequently work with structured data formats like JSON, YAML, and CSV ‚Äì\nsuch as developers interacting with APIs, system administrators managing\nconfigurations, and data professionals ‚Äì will likely find Nushell‚Äôs native\ndata handling and powerful pipeline capabilities a plus. Additionally, users\nwho value a more consistent and safer scripting experience might appreciate\nNushell‚Äôs language-first design and features like strong typing.</p>","tags":["nushell","shells"],"title":"Intro to Nushell"},{"author":"saylesss88","collection":"blog","date":"2025-11-30T00:00:00+00:00","description":null,"draft":false,"path":"functions/functions_and_modules_2.2.md","preview_html":"<p>When you start exploring NixOS configurations or tools like Home Manager, you‚Äôll\nencounter a concept called Nix Modules. Modules are also functions, but they\nbehave differently regarding their arguments, which can be a source of\nconfusion.</p><p><strong>What are NixOS Modules</strong>?</p><p>Nix Modules are a powerful system built on top of basic Nix functions, primarily\nused for declarative system configurations (like NixOS, Home Manager, NixOps,\netc.). They allow you to define parts of your system configuration in separate\nfiles that are then composed together.</p>","tags":["nixos","functions"],"title":"Functions and NixOS Modules"},{"author":"saylesss88","collection":"notes","date":"2025-11-29T00:00:00+00:00","description":null,"draft":false,"path":"Intro_to_Nix_Derivations_7.md","preview_html":"<p><img src=\"images/gruv10.png\" alt=\"gruv10\" /></p><p>Nix‚Äôs build instructions, known as <strong>derivations</strong>, are defined using the Nix\nLanguage. These derivations can describe anything from individual software\npackages to complete system configurations. The Nix package manager then\ndeterministically ‚Äúrealizes‚Äù (builds) these derivations, ensuring consistency\nbecause they rely solely on a predefined set of inputs.</p><p>Most things in NixOS are built around derivations. Your NixOS system is\ndescribed by such a single system derivation. When you want to apply a new\nconfiguration, <code>nixos-rebuild</code> handles the process:</p>","tags":["notes","derivations"],"title":"Intro to Derivations"},{"author":"saylesss88","collection":"blog","date":"2025-11-28T00:00:00+00:00","description":null,"draft":false,"path":"flakes/flake_outputs_4.2.md","preview_html":"<p>Flake outputs are what the flake produces when built. Flakes can have multiple\noutputs simultaneously such as:</p><p><strong>Packages</strong>: Self-contained bundles that are built using derivations and\nprovide either some kind of software or dependencies of software.</p><p><a href=\"https://saylesss88.github.io/NixOS_Modules_Explained_3.html\">NixOS modules</a></p>","tags":["nixos","flakes","outputs"],"title":"Flake outputs"},{"author":"saylesss88","collection":"blog","date":"2025-11-28T00:00:00+00:00","description":null,"draft":false,"path":"flakes/flake_inputs_4.1.md","preview_html":"<p>The attribute <code>inputs</code> specifies the dependencies of a flake, as an attrset\nmapping input names to flake references.</p><p>If a repository provides a <code>flake.nix</code> you can include it as an input in your\n<code>flake.nix</code>.</p><p>For example, I like yazi as my file explorer and have been using helix as my\neditor. To be able to get yazi to work with helix I needed the latest versions\nof both yazi and helix. One way to get the latest versions was to add their\nflakes as inputs to my flake:</p>","tags":["nixos","flakes"],"title":"Flake Inputs"},{"author":"saylesss88","collection":"blog","date":"2025-11-28T00:00:00+00:00","description":null,"draft":false,"path":"flakes/flake_examples_4.3.md","preview_html":"<p>This chapter provides practical examples to illustrate the concepts discussed in\n‚ÄúNix Flakes Explained.‚Äù</p><p>NixOS modules and configurations offer us a powerful and composable way to\ndefine and share system configurations. Imagine we have several independent\n‚Äúplayers,‚Äù each with their own unique set of configurations or modules. How do\nwe combine these individual contributions into a single, cohesive system without\ndirectly altering each player‚Äôs original flake?</p><p>This example demonstrates how flakes can extend and compose each other, allowing\nyou to layer configurations on top of existing ones. This is particularly useful\nwhen you want to:</p>","tags":["nixos","flakes"],"title":"Flake outputs"},{"author":"saylesss88","collection":"blog","date":"2025-11-27T00:00:00+00:00","description":null,"draft":false,"path":"Nix_Pull_Requests_11.md","preview_html":"<p><img src=\"images/gruv16.png\" alt=\"gruv16\" /></p><p><strong>Pull requests</strong> communicate changes to a branch in a repository. Once a pull\nrequest is opened, you can review changes with collaborators and add follow-up\ncommits.</p><p>A <strong>pull request</strong> is a proposal to merge a set of changes from one branch\ninto another. In a pull request, collaborators can review and discuss the\nproposed set of changes before they integrate the changes into the main\ncodebase.</p>","tags":["nixos","nixpkgs"],"title":"Nix Pull Requests"},{"author":"saylesss88","collection":"blog","date":"2025-11-24T00:00:00+00:00","description":null,"draft":false,"path":"installation/unenc/unenc_impermanence.md","preview_html":"<p>Figure 1: Impermanence Logo: Image of the Impermanence logo. Sourced from the</p><p><a href=\"https://github.com/nix-community/impermanence\">Impermanence repo</a></p><p>This guide is for an unencrypted setup, there are a few links at the end for\nencrypted setups. This guide follows the previous\n<a href=\"https://saylesss88.github.io/installation/unencrypted_setups.html\">minimal install guide</a>\nbut you should be able to adjust it carefully to meet your needs.</p>","tags":["nixos","btrfs","impermanence"],"title":"Unencrypted BTRFS Impermanence with Flakes"},{"author":"saylesss88","collection":null,"date":"2025-11-22T00:00:00+00:00","description":null,"draft":false,"path":"nixpkgs/overlay.md","preview_html":"<p>The following is done with a local clone of Nixpkgs located at <code>~/src/nixpkgs</code>.</p><p>In this example, we will create an overlay to override the version of\n<code>btrfs-progs</code>. In the root directory of our local clone of Nixpkgs\n(i.e.<code>~/src/nixpkgs</code>) we can run the following command to locate <code>btrfs-progs</code>\nwithin Nixpkgs:</p><pre><code class=\"language-bash\">fd 'btrfs-progs' .\n./pkgs/by-name/bt/btrfs-progs/\n</code></pre>\n<p>Open the <code>package.nix</code> in the above directory and copy the <code>src</code> block within\nthe <code>stdenv.mkDerivation</code> block like so:</p>","tags":[],"title":"Nixpkgs Overlays"},{"author":"saylesss88","collection":null,"date":"2025-11-22T00:00:00+00:00","description":null,"draft":false,"path":"nixpkgs/local_package.md","preview_html":"<p>This chapter demonstrates the fundamental pattern for creating a package. Every\npackage recipe is a file that declares a function. This function takes the\npackages dependencies as argument.</p><p>In this example we‚Äôll make a simple package with <code>coreutils</code> and build it.\nDemonstrating the process of building and testing a local package.</p><p>This chapter will assume you have already have a cloned fork of Nixpkgs. I\nchoose to clone mine to the <code>~/src/</code> directory.</p>","tags":[],"title":"Local Nixpkgs"},{"author":"saylesss88","collection":"notes","date":"2025-11-22T00:00:00+00:00","description":null,"draft":false,"path":"nixpkgs/fork_clone_contribute.md","preview_html":"<p>In the <a href=\"https://github.com/NixOS/nixpkgs\">Nixpkgs</a> Repository.</p><p>Click Fork, then Create a new Fork.</p><p>Uncheck the box ‚ÄúOnly fork the <code>master</code> branch‚Äù, for development we will need\nmore branches.</p>","tags":["git","vcs","nixpkgs"],"title":"Fork, Clone, Contribute"},{"author":"saylesss88","collection":null,"date":"2025-11-22T00:00:00+00:00","description":null,"draft":false,"path":"nix/nix_package_manager.md","preview_html":"<p>Nix is a <em>purely functional package manager</em>. This means that it treats packages\nlike values in purely functional programming languages ‚Äì they are built by\nfunctions that don‚Äôt have side-effects, and they never change after they have\nbeen built.</p><p>Nix stores packages in the <em>Nix store</em>, usually the directory <code>/nix/store</code>,\nwhere each package has its own unique subdirectory such as:</p><pre><code class=\"language-bash\">/nix/store/y53c0lamag5wpx7vsiv7wmnjdgq97yd6-yazi-25.5.14pre20250526_74a8ea9\n</code></pre>\n<p>You can use the Nix on most Linux distributions and Mac OS also has good support\nfor Nix. It should work on most platforms that support POSIX threads and have a\nC++11 compiler.</p>","tags":[],"title":"Nix Package Manager"},{"author":"saylesss88","collection":null,"date":"2025-11-22T00:00:00+00:00","description":null,"draft":false,"path":"nix/nix_language.md","preview_html":"<p>The Nix language is designed for conveniently creating and composing\n<em>derivations</em> precise descriptions of how contents of files are used to derive\nnew files. ‚Äì<a href=\"https://nix.dev/manual/nix/2.28/language/\">Nix Reference Manual</a></p><p>Nix is often described as ‚ÄúJSON with functions.‚Äù It‚Äôs a declarative language\nwhere you define outcomes, not step-by-step instructions. Instead of writing\nsequential code, you create expressions that describe data structures,\nfunctions, and dependencies. These expressions are evaluated lazily, meaning Nix\ncomputes values only when needed, making it efficient for managing large\nsystems.</p><p>You can plug most of the following into the <code>nix repl</code> I‚Äôm showing it in a\nsingle code block here for brevity:</p>","tags":[],"title":"Nix Lang"},{"author":"saylesss88","collection":null,"date":"2025-11-22T00:00:00+00:00","description":null,"draft":false,"path":"nix/nixLang/nix_paths.md","preview_html":"<p>The following examples are done with a local <code>nixpkgs</code> clone located at\n<code>~/src/nixpkgs</code></p><p>Paths in Nix always need a <code>/</code> in them and always expand to absolute paths\nrelative to your current directory.</p><pre><code class=\"language-bash\">nix repl\nnix-repl&gt; ./.\n/home/jr/src/nixpkgs\nnix-repl&gt; ./. + \"/lib\"\n/home/jr/src/nixpkgs/lib\n</code></pre>\n<p>Nix does <em>path normalization</em> every time you append strings, so if you just add\na slash <code>/</code> its not actually there:</p>","tags":[],"title":"Nix Paths"},{"author":"saylesss88","collection":"notes","date":"2025-11-22T00:00:00+00:00","description":null,"draft":false,"path":"nix/impermanence.md","preview_html":"<p>Figure 1: <strong>Impermanence Logo</strong>: Image of the Impermanence logo. Sourced from\nthe</p><p><a href=\"https://github.com/nix-community/impermanence\">Impermanence repo</a></p><p><img src=\"../images/Impermanence.png\" alt=\"Impermanence Logo\" /></p>","tags":["impermanence","security"],"title":"Unencrypted Impermanence"},{"author":"saylesss88","collection":null,"date":"2025-11-22T00:00:00+00:00","description":null,"draft":false,"path":"nix/README.md","preview_html":"<p>üìå <strong>How to Use This Guide</strong></p><p><strong>Read warnings</strong>: Advanced hardening can break compatibility or cause data\nloss! Pause and research before enabling anything not listed above unless you\nunderstand the consequences.</p><p><strong>Hardening NixOS</strong>:</p>","tags":[],"title":"Readme1"},{"author":"saylesss88","collection":null,"date":"2025-11-22T00:00:00+00:00","description":null,"draft":false,"path":"installation/unenc/unencrypted_setups.md","preview_html":"<p>Figure 1: BTRFS Logo: Image of the BTRFS logo. Sourced from the BTRFS repo BTRFS\nlogo</p><p>Why I Chose BTRFS I chose BTRFS because I was already familiar with it from\nusing it with Arch Linux and I found it to be very easy to use. From what I‚Äôve\nread, there are licensing issues between the Linux Kernel and ZFS which means\nthat ZFS is not part of the Linux Kernel; it‚Äôs maintained by the OpenZFS project\nand available as a separate kernel module. This can cause issues and make you\nthink more about your filesystem than I personally want to at this point.</p><p>A <strong>Btrfs subvolume</strong> is essentially a distinct section within a Btrfs\nfilesystem that maintains its own set of files and directories, along with a\nseparate inode numbering system. Unlike block-level partitions (such as ","tags":[],"title":"Unencrypted Install"},{"author":"saylesss88","collection":null,"date":"2025-11-22T00:00:00+00:00","description":null,"draft":false,"path":"installation/enc/encrypted_impermanence.md","preview_html":"<p>‚ùó Important Note: This guide details a setup involving encrypted partitions\nand impermanent NixOS. While powerful, such configurations require careful\nattention to detail. Incorrect steps, especially concerning encryption keys or\npersistent data paths, can lead to <strong>permanent data loss</strong>. Please read all\ninstructions thoroughly before proceeding and consider backing up any critical\ndata beforehand. This has only been tested with the disk layout described in\n<a href=\"https://saylesss88.github.io/installation/encrypted_manual.html\">Encrypted Setups</a></p><p>As a system operates, it gradually accumulates state on its root partition. This\nstate is stored in various directories such as <code>/etc</code> and <code>/var</code>, capturing all\nthe configuration changes, logs, and o","tags":[],"title":"Encrypted Impermanence"},{"author":"saylesss88","collection":null,"date":"2025-11-22T00:00:00+00:00","description":null,"draft":false,"path":"installation/enc/sops-nix.md","preview_html":"<p><a href=\"https://github.com/getsops/sops?ref=blog.gitguardian.com\">SOPS</a>, short for\n<strong>S</strong>ecrets<strong>OP</strong>eration<strong>S</strong>, is an editor of encrypted files that supports\nquite a few BINARY formats and encrypts with AWS KMS, GCP KMS, Azure Key Vault,\nage, and PGP.</p><p>Managing secrets‚Äîlike API keys, SSH deploy keys, and password hashes is a\ncritical part of system configuration, but it‚Äôs also one of the trickiest to do\nsecurely and reproducibly. Traditionally, secrets might be stored in ad hoc\nlocations, referenced by absolute paths, or managed manually outside of version\ncontrol. This approach makes it hard to share, rebuild, or audit your\nconfiguration, and increases the risk of accidental leaks or inconsistencies\nbetween systems.</p><p><code>sops-nix","tags":[],"title":"Sops-Nix"},{"author":"saylesss88","collection":null,"date":"2025-11-22T00:00:00+00:00","description":null,"draft":false,"path":"installation/enc/lanzaboote.md","preview_html":"<p>‚ö†Ô∏è <strong>Warning: This can easily brick your system</strong> ‚ö†Ô∏è</p><p>We will mainly follow the lanzaboote\n<a href=\"https://github.com/nix-community/lanzaboote/blob/master/docs/QUICK_START.md\">Quick Start Guide</a></p><p>For Windows dual-booters and BitLocker users, you should export your BitLocker\nrecovery keys and confirm that they are correct. Refer to this\n<a href=\"https://support.microsoft.com/en-us/windows/find-your-bitlocker-recovery-key-6b71ad27-0b89-ea08-f143-056f5ab347d6\">Microsoft support article</a></p>","tags":[],"title":"Lanzaboote"},{"author":"saylesss88","collection":null,"date":"2025-11-22T00:00:00+00:00","description":null,"draft":false,"path":"installation/enc/enc_install.md","preview_html":"<p>NixOS supports file systems that are encrypted using LUKS (Linux Unified Key\nSetup). This guide walks you through an encrypted NixOS installation using Disko\nfor disk management and Btrfs for subvolumes. It is designed for users who want\nfull disk encryption and a modern filesystem layout. If you prefer an\nunencrypted setup, you can skip the LUKS and encryption steps, but this guide\nfocuses on security and flexibility.</p><p>If you choose to set up impermanence, ensure it matches your install. Encrypted\nSetup with Encrypted Impermanence and Unencrypted Setup with Unencrypted\nImpermanence.</p><p>‚ùó NOTE: This is a bit convoluted, there are a few paths you can follow. If\nyou choose to use the starter repo (<a href=\"https://github.com/saylesss88/my-flake\">https://github.com/saylesss88/my-fl","tags":[],"title":"Encrypted Install"},{"author":"saylesss88","collection":null,"date":"2025-11-22T00:00:00+00:00","description":null,"draft":false,"path":"installation/enc/USB_keyfile.md","preview_html":"<p>This allows you to use a USB stick for your keyfile, with a backup in case you\nwant or need it. There is a setting <code>fallbackToPassword</code> that protects you in\ncase something fails with the USB key.</p><p>First, I‚Äôll show how to set up a dedicated USB stick for a keyfile. (i.e., one\nthat is only used for this). After that I will show the process of adding the\nkeyfile to a USB stick with existing data on it that you don‚Äôt want to lose.</p><p><strong>Generate the keyfile</strong></p>","tags":[],"title":"USB Keyfile"},{"author":"saylesss88","collection":null,"date":"2025-11-22T00:00:00+00:00","description":null,"draft":false,"path":"installation/README.md","preview_html":"<p>This section provides detailed guides for installing NixOS. You‚Äôll choose\nbetween an <strong>unencrypted</strong> or <strong>encrypted</strong> base setup. After your core\ninstallation, you can explore adding optional features like <code>sops</code> for encrypted\nsecrets, <code>lanzaboote</code> for Secure Boot, or <code>impermanence</code> for a stateless system.</p><p><strong>Guide:</strong>\n<a href=\"https://saylesss88.github.io/installation/unenc/unencrypted_setups.html\">Minimal Btrfs-Subvol Install with Disko and Flakes</a></p><p><strong>Best for:</strong></p>","tags":[],"title":"My Chapter"},{"author":"saylesss88","collection":"blog","date":"2025-11-22T00:00:00+00:00","description":null,"draft":false,"path":"functions/practical_functions_2.1.md","preview_html":"<p><img src=\"images/coding6.png\" alt=\"coding6\" /></p><p><a href=\"https://gitlab.com/api/v4/projects/4207231/packages/generic/graphviz-releases/2.49.3/graphviz-2.49.3.tar.gz\">graphviz</a></p><p><a href=\"https://ftp.gnu.org/gnu/hello/hello-2.12.1.tar.gz\">hello</a></p>","tags":["nixos","functions"],"title":"Practical Nix Functions"},{"author":"saylesss88","collection":"blog","date":"2025-11-22T00:00:00+00:00","description":null,"draft":false,"path":"flakes/overlays_4.5.md","preview_html":"<p><img src=\"../images/pokego.png\" alt=\"Pokego Logo\" />‚Äì<a href=\"https://github.com/rubiin/pokego\">pokego repo</a></p><p>Overlays are Nix functions that accept two arguments, <code>final</code> and <code>prev</code> and\nreturn a set of packages. Overlays are similar to <code>packageOverrides</code> as a way to\ncustomize Nixpkgs, <code>packageOverrides</code> acts as an overlay with only the <code>prev</code>\nargument. Therefore, <code>packageOverrides</code> is appropriate for basic use, but\noverlays are more powerful and easier to distribute.</p><p>Example:</p>","tags":["nixos","overlays","outputs"],"title":"Overlays"},{"author":"saylesss88","collection":null,"date":"2025-11-22T00:00:00+00:00","description":null,"draft":false,"path":"Working_with_Nixpkgs_Locally_10.md","preview_html":"<p><img src=\"images/server_rack.cleaned.png\" alt=\"server_rack\" /></p><p>Nixpkgs, the package repository for NixOS, is a powerful resource for building\nand customizing software.</p><p>Working with a local copy enhances development, debugging, and contribution\nworkflows.</p>","tags":[],"title":"Local Nixpkgs"},{"author":"saylesss88","collection":null,"date":"2025-11-22T00:00:00+00:00","description":null,"draft":false,"path":"Debugging_and_Tracing_NixOS_Modules_9.md","preview_html":"<p>This chapter covers debugging NixOS modules, focusing on tracing module options\nand evaluating merges.</p><p><img src=\"images/coding4.png\" alt=\"404\" /></p><p><a href=\"https://saylesss88.github.io/posts/nix_modules_explained/\">nix-modules-explained</a></p>","tags":[],"title":"Debugging NixOS modules"},{"author":"saylesss88","collection":null,"date":"2025-11-22T00:00:00+00:00","description":null,"draft":false,"path":"Comparing_Flakes_and_Traditional_Nix_8.md","preview_html":"<p>A key benefit of Nix Flakes is their <em>default</em> enforcement of <strong>pure\nevaluation</strong>.</p><p>In Nix, an <strong>impure operation</strong> depends on something <em>outside</em> its explicit\ninputs. Examples include:</p><p>Impurity leads to unpredictable builds that may differ across systems or time.</p>","tags":[],"title":"Comparing Flakes and Traditional Nix"},{"author":"saylesss88","collection":null,"date":"2025-11-21T00:00:00+00:00","description":null,"draft":false,"path":"Understanding_Top-Level_Attributes_5.md","preview_html":"<p>This explanation is based on insights from Infinisil, a prominent figure in the\nNix community, to help clarify the concept of top-level attributes within NixOS\nmodules.</p><p>In a NixOS system, everything is built from a single ‚Äúsystem derivation.‚Äù The\ncommand <code>nix-build '&lt;nixpkgs/nixos&gt;' -A system</code> initiates this build process.</p><p>The <code>-A system</code> part tells Nix to focus on the <code>system</code> attribute defined in the\n<code>'&lt;nixpkgs/nixos&gt;'</code> file (which is essentially <code>./default.nix</code> within the\nNixpkgs repository).</p>","tags":[],"title":"Top-Level Attributes"},{"author":"saylesss88","collection":null,"date":"2025-11-21T00:00:00+00:00","description":null,"draft":false,"path":"Understanding_Nix_Functions_2.md","preview_html":"<p><img src=\"images/trees2.cleaned.png\" alt=\"trees2\" /></p><p><strong>Functions</strong> are the building blocks of Nix, appearing everywhere in Nix\nexpressions and configurations. Mastering them is essential for writing\neffective Nix code and understanding tools like NixOS and Home Manager. This\nchapter explores how Nix functions work, focusing on their <strong>single-argument\nnature</strong>, <strong>currying</strong>, <strong>partial application</strong>, and their role in <strong>modules</strong>.</p><p>A <strong>Nix Function</strong> is a rule that takes an input (called an <strong>argument</strong>) and\nproduces an <strong>output</strong> based on that input. Unlike many programming languages,\nNix functions are designed to take exactly one argument at a time. This unique\napproach, co","tags":[],"title":"Understanding Nix Functions"},{"author":"saylesss88","collection":null,"date":"2025-11-21T00:00:00+00:00","description":null,"draft":false,"path":"Package_Definitions_Explained_6.md","preview_html":"<p><img src=\"images/coding2.png\" alt=\"coding2\" /></p><p>In Nix, the concept of a <strong>package</strong> can refer to two things:</p><p>A collection of files and data that constitute a piece of software or an\nartifact.</p>","tags":[],"title":"Package Definitions Explained"},{"author":"saylesss88","collection":null,"date":"2025-11-21T00:00:00+00:00","description":null,"draft":false,"path":"Nix_Flakes_Explained_4.md","preview_html":"<p><img src=\"images/trees3.cleaned.png\" alt=\"trees3\" /></p><p>If you‚Äôre completely new, take a look at\n<a href=\"https://nixos.wiki/wiki/flakes#Installing_flakes\">this</a> to get flakes on your\nsystem.</p><p>For the Nix Flake man page type <code>man nix3 flake</code> and for a specific feature,\ntype something like <code>man nix3 flake-lock</code>.</p>","tags":[],"title":"Nix Flakes Explained"},{"author":"saylesss88","collection":null,"date":"2025-11-21T00:00:00+00:00","description":null,"draft":false,"path":"NixOS_Modules_Explained_3.md","preview_html":"<p><img src=\"images/buildings1.png\" alt=\"buildings\" /></p><p><strong>TL;DR</strong>: In this chapter, we will break down the Nix module system used by\nboth NixOS and Home-Manager. We will discuss using home-manager as a module and\nthe flexibility that modules give us. We will touch on options and break down\nthe <code>vim</code> module from the Nixpkgs collection. Finally we will display how to\ntest modules with the repl.</p><p>Your <code>configuration.nix</code> is a module. For the Nixpkgs collection most modules\nare in <code>nixos/modules</code>.</p>","tags":[],"title":"Nix Module System Explained"},{"author":"saylesss88","collection":null,"date":"2025-11-21T00:00:00+00:00","description":null,"draft":false,"path":"Getting_Started_with_Nix_1.md","preview_html":"<p><img src=\"images/trees1.cleaned.png\" alt=\"trees\" /></p><p>Welcome to <em>nix-book</em>, an introductory book about Nix. This book leans more\ntowards using Flakes but will contrast traditional Nix where beneficial.\nOriginally, this content started as a blog. I‚Äôm refining its flow to make it\nmore cohesive.</p><p>In this chapter, I will touch on the different parts of the Nix ecosystem, give\na quick example of each and explain how they fit together.</p>","tags":[],"title":"Intro to Nix"}],"generated_at":"2026-01-18T18:14:20.696968489+00:00"};</script>
<h1 id="chapter-12"><a class="header" href="#chapter-12">Chapter 12</a></h1>
<details>
<summary> ‚úîÔ∏è Click to Expand Table of Contents</summary>
<ul>
<li><a href="#intro-to-nushell-on-nixos">Intro to Nushell on NixOS</a></li>
<li><a href="#the-good">The Good</a>
<ul>
<li><a href="#the-bad">The Bad</a></li>
<li><a href="#key-differences-between-nushell--bash">Key Differences Between Nushell &amp; Bash</a></li>
<li><a href="#the-beautiful-and-powerful">The Beautiful and Powerful</a></li>
</ul>
</li>
<li><a href="#using-just-and-justfiles">Using Just and Justfiles</a>
<ul>
<li><a href="#resources">Resources</a></li>
</ul>
</li>
</ul>
</details>
<p><img src="images/nu.png" alt="Nu"></p>
<h2 id="intro-to-nushell-on-nixos"><a class="header" href="#intro-to-nushell-on-nixos">Intro to Nushell on NixOS</a></h2>
<ul>
<li>
<p><strong>TL;DR</strong>:I recently switched default shells from zsh to nushell, this post is
about some of the challenges and advantages of using nushell with NixOS.</p>
</li>
<li>
<p>While the average user might not immediately see significant advantages, those
who frequently work with structured data formats like JSON, YAML, and CSV ‚Äì
such as developers interacting with APIs, system administrators managing
configurations, and data professionals ‚Äì will likely find Nushell‚Äôs native
data handling and powerful pipeline capabilities a plus. Additionally, users
who value a more consistent and safer scripting experience might appreciate
Nushell‚Äôs language-first design and features like strong typing.</p>
</li>
<li>
<p>I‚Äôll start with some of the unique build design choices and unique features
that I think make Nushell special, then show an example using Nushell to
manipulate JSON data. Finally, I will highlight some of the visually appealing
aspects of Nushell and lastly I share some resources for learning more.</p>
</li>
</ul>
<h2 id="the-good"><a class="header" href="#the-good">The Good</a></h2>
<ul>
<li>
<p>Nushell borrows concepts from many shells and languages and is itself both a
programming language and a shell. Because of this, it has its own way of
working with files, directories, websites, and more.</p>
</li>
<li>
<p>Nushell is powerful and has many essential commands built directly into the
shell (‚Äúinternal‚Äù commands) rather than a link to an executable. You can use
this set of commands across different operating systems, having this
consistency is helpful when creating cross-platform code.</p>
</li>
<li>
<p>When internal Nushell commands (like <code>ls</code>, <code>open</code>, <code>where</code>, <code>get</code>, <code>sort-by</code>,
etc.) produce output, they generally do so in Nushell‚Äôs structured data format
(tables or records). This is the shell‚Äôs native way of representing
information.</p>
</li>
<li>
<p>Beyond these foundational strengths, Nushell offers a range of unique features
that enhance its functionality and make it particularly well-suited for
data-heavy tasks. Here are some highlights that showcase its versatility.</p>
</li>
</ul>
<p><strong>Some Unique Features</strong>:</p>
<ul>
<li>
<p>Besides the built-in commands, Nushell has a
<a href="https://www.nushell.sh/book/standard_library.html">standard library</a> Nushell
operates on <em>structured data</em>. You could call it a ‚Äúdata-first‚Äù shell and
programming language.</p>
</li>
<li>
<p>Also included, is a full-featured dataframe processing engine using
<a href="https://github.com/pola-rs/polars">Polars</a> if you want to process large data
efficiently directly in your shell, check out the
<a href="https://www.nushell.sh/book/dataframes.html">Dataframes-Docs</a></p>
</li>
<li>
<p><strong>Multi-Line Editing</strong>:</p>
</li>
<li>
<p>When writing a long command you can press Enter to add a newline and move to
the next line. For example:</p>
</li>
</ul>
<pre><code class="language-nu">ls            |    # press enter
where name =~ |    # press enter, comments after pipe ok
get name      |    # press enter
mv ...$in ./backups/
</code></pre>
<ul>
<li>
<p>This allows you to cycle through the entire multi-line command using the up
and down arrow keys and then customize different lines or sections of the
command.</p>
</li>
<li>
<p>You can manually insert a newline using <code>Alt+Enter</code> or <code>Shift+Enter</code>.</p>
</li>
<li>
<p>The <a href="https://www.nushell.sh/book/line_editor.html">Reedline-Editor</a> is
powerful and provides good <code>vi-mode</code> or <code>emacs</code> support built in.</p>
</li>
<li>
<p>It‚Äôs default <code>Ctrl+r</code> history command is nice to work with out of the box.</p>
</li>
<li>
<p>The <a href="https://www.nushell.sh/book/explore.html#parameters">explore</a> command, is
nu‚Äôs version of a table pager, just like <code>less</code> but for table structured data:</p>
</li>
</ul>
<pre><code class="language-nu">$nu | explore --peek
</code></pre>
<ul>
<li>
<p>With the above command you can navigate with vim keybinds or arrow keys.</p>
</li>
<li>
<p>These features demonstrate Nushell‚Äôs user-friendly interface, but what truly
sets it apart is its underlying design as a structured data scripting
language. This ‚Äúlanguage-first‚Äù approach powers many of its distinctive
capabilities.</p>
</li>
</ul>
<p><img src="images/explore.png" alt="explore"></p>
<p><strong>Unique design</strong>:</p>
<ul>
<li>
<p><strong>Fundamentally designed as a structured data scripting language</strong>: and then
it acts as a shell on top of that foundation. This ‚Äúlanguage first‚Äù approach
is what gives it many of its distinctive features and makes it a powerful
scripting language. I reiterate this here because of the implications of this.
A few of those features are:</p>
<ul>
<li>
<p><strong>Pipelines of structured data</strong>: Unlike traditional shells that primarily
deal with plain text streams, Nushell pipelines operate on tables of
structured data. Each command can understand and manipulate this structured
data directly.</p>
</li>
<li>
<p><strong>Consistent syntax</strong>: Its syntax is more consistent and predictable
compared to the often quirky syntax of Bash and Zsh, drawing inspiration
from other programming languages.</p>
</li>
<li>
<p><strong>Strong typing</strong> Nushell has a type system, which helps catch errors early
and allows for more robust scripting.</p>
</li>
<li>
<p><strong>First-class data types</strong>: It treats various data formats (like JSON, CSV,
TOML) as native data types, making it easier to work with them. Because of
this, Nushell aims to replace the need for external tools like <code>jq</code>, <code>awk</code>,
<code>sed</code>, <code>cut</code>, and even some uses of <code>grep</code> and <code>curl</code>.</p>
</li>
</ul>
</li>
<li>
<p><strong>Variables are Immutable by Default</strong>: Nushell‚Äôs commands are based on a
functional-style of programming which requires immutability, sound familiar?</p>
</li>
<li>
<p><strong>Nushell‚Äôs Environment is Scoped</strong>: Nushell takes many design cues from
compiled languages, one is that languages should avoid global mutable state.
Shells have commonly used global mutation to update the environment, Nushell
attempts to steer clear of this increasing reproducability.</p>
</li>
<li>
<p><strong>Single-use Environment Variables</strong>:</p>
</li>
</ul>
<pre><code class="language-nu">FOO=BAR $env.FOO
# =&gt; BAR
</code></pre>
<ul>
<li><strong>Permanent Environment Variables</strong>: In your <code>config.nu</code></li>
</ul>
<pre><code class="language-nu"># config.nu
$env.FOO = 'BAR'
</code></pre>
<ul>
<li>
<p><a href="https://www.nushell.sh/book/coming_from_bash.html">Coming-From-Bash</a></p>
</li>
<li>
<p>These design principles make Nushell a powerful tool for scripting, but
they‚Äôre best understood through a hands-on example. Let‚Äôs see how Nushell‚Äôs
structured data capabilities shine in a common task: processing a JSON file.</p>
</li>
</ul>
<p><strong>Example</strong>: I wanted to provide a practical example to illustrate some of these
‚ÄúGood‚Äù features in action. And break it down for better understanding.</p>
<ul>
<li>
<p>Let‚Äôs consider a common task: processing data from a JSON file. Imagine you
have a file containing a list of users with their names and ages. With
traditional shells, you‚Äôd likely need to rely on external tools like <code>jq</code> to
parse and filter this data. However, Nushell can handle this directly within
its own commands.</p>
</li>
<li>
<p>For this example you could create a <code>test</code> directory and move to it:</p>
</li>
</ul>
<pre><code class="language-bash">mkdir test ; cd test
</code></pre>
<ul>
<li>Create a <code>users.json</code> with the following contents:</li>
</ul>
<p>üëá users.json</p>
<pre><code class="language-json">[
  { "name": "Alice", "age": 25 },
  { "name": "Bob", "age": 30 },
  { "name": "Charlie", "age": 20 }
]
</code></pre>
<ul>
<li>And create the following <code>filter.nu</code> that first converts <code>users.json</code> into its
own internal structured data format with the <code>open</code> command, then to filters
out people under <code>21</code> with the <code>where</code> control flow construct, then selects
the <code>name</code> and <code>age</code> columns, sorts them by age, and finally converts them
back to <code>json</code> and saves them to a file called <code>filtered_users.json</code>. A lot
happening in a 6 line script.</li>
</ul>
<pre><code class="language-nu"># filter.nu
open users.json           # Read JSON file into structured data
| where age &gt; 21         # Filter users older than 21
| select name age        # Select only name and age columns
| sort-by age            # Sort by age
| to json                # Convert back to JSON
| save filtered_users.json # Save result to a new file
</code></pre>
<ul>
<li>The <code>open</code> command takes data from a file (or even a URL in some cases) and
parses it and converts it into Nushells own internal structured data format.
So this command isn‚Äôt just showing you the contents of <code>users.json</code> but doing
a conversion to Nu‚Äôs special structured format.</li>
</ul>
<pre><code class="language-nu">open users.json
‚ï≠‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ïÆ
‚îÇ # ‚îÇ  name   ‚îÇ age ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ 0 ‚îÇ Alice   ‚îÇ  25 ‚îÇ
‚îÇ 1 ‚îÇ Bob     ‚îÇ  30 ‚îÇ
‚îÇ 2 ‚îÇ Charlie ‚îÇ  20 ‚îÇ
‚ï∞‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ïØ
</code></pre>
<ul>
<li>The <code>source</code> command in Nushell is used to execute the commands within a
script file (like <code>filter.nu</code>) in the current Nushell environment. It‚Äôs
similar to running the script directly in the shell, but keeps the shell open
for further use. In this example, <code>source filter.nu</code> runs the commands inside
<code>filter.nu</code>, processing the <code>users.json</code> file and creating the
<code>filtered_users.json</code> file:</li>
</ul>
<pre><code class="language-nu">source filter.nu
# View the contents with bat
bat filtered_users.json
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
       ‚îÇ File: filtered_users.json
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
   1   ‚îÇ [
   2   ‚îÇ   {
   3   ‚îÇ     "name": "Alice",
   4   ‚îÇ     "age": 25
   5   ‚îÇ   },
   6   ‚îÇ   {
   7   ‚îÇ     "name": "Bob",
   8   ‚îÇ     "age": 30
   9   ‚îÇ   }
  10   ‚îÇ ]
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
</code></pre>
<ul>
<li>As you can see, without needing any external tools, Nushell was able to read,
filter, select, sort, and then re-serialize JSON data using a clear and
concise pipeline. This demonstrates its power in handling structured data
natively, making common data manipulation tasks within the shell significantly
more streamlined and readable compared to traditional approaches.</li>
</ul>
<p><strong>In the filter.nu example:</strong></p>
<pre><code class="language-nu"># filter.nu
open users.json           # Read JSON file into structured data
| where age &gt; 21         # Filter users older than 21
| select name age        # Select only name and age columns
| sort-by age            # Sort by age
| to json                # Convert back to JSON
| save filtered_users.json # Save result to a new file
</code></pre>
<details>
<summary> ‚úîÔ∏è Summary of above Command (Click to Expand)</summary>
<ol>
<li>
<p><code>open users.json</code>: Produces a <strong>Nushell table</strong> representing the data.</p>
</li>
<li>
<p><code>| where age &gt; 21</code>: Receives the table, filters rows based on the <code>age</code>
column, and outputs a new, filtered table.</p>
</li>
<li>
<p><code>| select name age</code>: Receives the filtered table, selects only the <code>name</code> and
<code>age</code> columns, and outputs a table with fewer columns.</p>
</li>
<li>
<p><code>| sort-by age</code>: Receives the table, sorts the rows based on the <code>age</code>
column, and outputs a sorted table.</p>
</li>
<li>
<p><code>| to json</code>: Receives the sorted table and converts it back into JSON text.</p>
</li>
<li>
<p><code>| save filtered_users.json</code>: Receives the JSON text and saves it to a file.</p>
</li>
</ol>
<ul>
<li>
<p>So, while the concept of piping is the same, the nature of the data flowing
through the Nushell pipeline is richer and more structured, enabling more
powerful and direct data manipulation.</p>
</li>
<li>
<p>While Nushell‚Äôs strengths, like its structured data pipelines, make it a
game-changer for many tasks, it‚Äôs not without its challenges, especially when
integrated with NixOS‚Äôs Bash-centric ecosystem. Let‚Äôs explore some of the
limitations you might encounter when adopting Nushell as your default shell.</p>
</li>
</ul>
</details>
<h3 id="the-bad"><a class="header" href="#the-bad">The Bad</a></h3>
<ul>
<li>
<p>While the project is still maturing, the active community and ongoing
improvements are promising. Don‚Äôt get too discouraged by the following, there
would be a bad section for any shell imo.</p>
</li>
<li>
<p>There are many similarities so it can be easy to forget that some Bash (and
POSIX in general) style constructs just won‚Äôt work in Nushell. Considering
that NixOS seems to have been designed for bash, even Zsh isn‚Äôt fully
compatable you may want to think twice before you choose Nushell as your
default.</p>
</li>
<li>
<p>The documentation is incomplete and written by devs for devs imo, it is quite
a bit different from anything else I‚Äôve seen so there is a bit of a learning
curve. Nushell is generally still considered to be in a stage where it might
not be the most seamless or trouble-free experience as a daily driver default
shell for most users, especially on a system like NixOS known for its unique
approach.</p>
</li>
<li>
<p>The <a href="https://github.com/haslersn/any-nix-shell">any-nix-shell</a> project doesn‚Äôt
include Nushell as with many others because of it‚Äôs lack of maturity.</p>
</li>
<li>
<p>The following addition comes from Joey_McKur‚Äôs sugggestion, on mentioning the
<code>job</code> command as one of the biggest criticisms against Nu because it doesn‚Äôt
support background tasks. I should also note that Nushell‚Äôs team is aware of
these criticisms and actively working on improving job control.</p>
</li>
</ul>
<p><strong>Limited Feature Set Compared to Traditional Job Control:</strong></p>
<ul>
<li>
<p><strong>Lack of Full POSIX Job Control</strong>: Nushell‚Äôs job control doesn‚Äôt yet fully
implement all the features and signals defined by POSIX job control (e.g.,
more nuanced signal handling, stopped jobs). While it covers the basics, users
accustomed to advanced Bash job control might find it lacking.</p>
</li>
<li>
<p><strong>Foregrounding Behavior</strong>: There have been criticisms about how foregrounding
jobs interacts with the terminal and potential issues with signal propagation.</p>
</li>
</ul>
<p><strong>Output Handling Challenges</strong>:</p>
<ul>
<li>
<p><strong>Interleaved Output</strong>: Managing the output of multiple backgrounded jobs can
sometimes be messy, with output from different jobs potentially interleaving
in the terminal. While Nushell tries to handle this, it‚Äôs not always as clean
as desired.</p>
</li>
<li>
<p><strong>Redirection Complexity</strong>: Redirecting the input and output of backgrounded
jobs can be less straightforward than in Bash, sometimes requiring more
explicit handling.</p>
</li>
</ul>
<p><strong>Integration with Pipelines:</strong></p>
<ul>
<li><strong>Backgrounding Pipelines</strong>: Backgrounding complex pipelines with multiple
stages can sometimes lead to unexpected behavior or difficulties in managing
the entire pipeline as a single job.</li>
</ul>
<p><strong>Error Reporting:</strong></p>
<ul>
<li>
<p><strong>Difficult to Track Errors in Background Jobs</strong>: Identifying and debugging
errors in backgrounded jobs can be less direct than with foreground processes,
and the job command‚Äôs output might not always provide sufficient information
for troubleshooting.</p>
</li>
<li>
<p>Many of Nushell‚Äôs challenges stem from its departure from traditional shell
conventions, particularly those of Bash, which NixOS heavily relies on. To
better understand these differences and how they impact your workflow, let‚Äôs
compare Nushell‚Äôs static, structured approach to Bash‚Äôs dynamic, text-based
model.</p>
</li>
</ul>
<h3 id="key-differences-between-nushell--bash"><a class="header" href="#key-differences-between-nushell--bash">Key Differences Between Nushell &amp; Bash</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th><strong>Feature</strong></th><th><strong>Bash (Dynamic)</strong></th><th><strong>Nushell (Static)</strong></th></tr>
</thead>
<tbody>
<tr><td>Code Execution</td><td>Line-by-line</td><td>Whole script parsed first</td></tr>
<tr><td>Error Detection</td><td>Runtime errors only</td><td>Catches errors before running</td></tr>
<tr><td>Support for <code>eval</code></td><td>‚úÖ Allowed</td><td>‚ùå Not supported</td></tr>
<tr><td>Custom Parsing</td><td>Limited</td><td>Built-in semantic analysis</td></tr>
<tr><td>IDE Features</td><td>Basic syntax highlighting</td><td>Advanced integration, linting, and formatting</td></tr>
</tbody>
</table>
</div>
<ul>
<li>
<p><code>&amp;&amp;</code> doesn‚Äôt work use <code>;</code> instead.</p>
</li>
<li>
<p><code>&gt;</code> is used as the greater-than operator for comparisons:</p>
</li>
</ul>
<pre><code class="language-nu">"hello" | save output.txt
</code></pre>
<p>is equivalent to the following in bash:</p>
<pre><code class="language-bash">echo "hello" &gt; output.txt
</code></pre>
<ul>
<li>If you notice above the nushell command doesn‚Äôt require an <code>echo</code> prefix, this
is because Nushell has <strong>Implicit Return</strong>:</li>
</ul>
<pre><code class="language-nu">"Hello, World" == (echo "Hello, World")
# =&gt; true
</code></pre>
<ul>
<li>
<p>The above example shows that the string, <code>"Hello, World"</code> is equivalent to the
output value from <code>echo "Hello, World"</code></p>
</li>
<li>
<p><strong>Every Command Returns a Value</strong>:</p>
</li>
</ul>
<pre><code class="language-nu">let p = 7
print $p  # 7
$p * 6    # 42
</code></pre>
<ul>
<li>Understanding these differences highlights why Nushell feels so distinct from
Bash, but it‚Äôs the shell‚Äôs advanced features and integrations that truly make
it shine. Let‚Äôs dive into some of the beautiful and powerful tools and custom
commands that elevate Nushell for NixOS users.</li>
</ul>
<h3 id="the-beautiful-and-powerful"><a class="header" href="#the-beautiful-and-powerful">The Beautiful and Powerful</a></h3>
<ul>
<li>
<p><code>Ctrl+t</code> List Commands with carapace and fzf:</p>
<p><img src="images/nu4.png" alt="nu4"></p>
</li>
<li>
<p><code>Carapace</code>
<a href="https://carapace-sh.github.io/carapace-bin/install.html">Carapace-Bin Install</a>:</p>
</li>
</ul>
<p>The folling is showing tab completion, I typed <code>hx fl&lt;TAB&gt;</code>:</p>
<p><img src="images/nu9.png" alt="nu9"></p>
<ul>
<li>
<p><code>Carapace</code> man example:</p>
<p><img src="images/nu7.png" alt="nu7"></p>
</li>
</ul>
<p><strong>Custom Nushell Commands</strong></p>
<p>Most of the following scripts come from the
<a href="https://github.com/nushell/nu_scripts#">nu_scripts repo</a></p>
<ul>
<li>The following command allows you to choose which input to update interactively
with fzf.</li>
</ul>
<details>
<summary> ‚úîÔ∏è Click to See Command</summary>
<pre><code class="language-nu"># nix.nu
# upgrade system packages
# `nix-upgrade` or `nix-upgrade -i`
def nix-upgrade [
  flake_path: string = "/home/jr/flake", # path that contains a flake.nix
  --interactive (-i) # select packages to upgrade interactively
]: nothing -&gt; nothing {
  let working_path = $flake_path | path expand
  if not ($working_path | path exists) {
    echo "path does not exist: $working_path"
    exit 1
  }
  let pwd = $env.PWD
  cd $working_path
  if $interactive {
    let selections = nix flake metadata . --json
    | from json
    | get locks.nodes
    | columns
    | str join "\n"
    | fzf --multi --tmux center,20%
    | lines
    # Debug: Print selections to verify
    print $"Selections: ($selections)"
    # Check if selections is empty
    if ($selections | is-empty) {
      print "No selections made."
      cd $pwd
      return
    }
    # Use spread operator to pass list items as separate arguments
    nix flake update ...$selections
  } else {
    nix flake update
  }
  cd $pwd
  nh os switch $working_path
}
</code></pre>
</details>
<p><strong>Usage</strong>:</p>
<pre><code class="language-nu">nix-upgrade
# or for individual packages
nix-upgrade -i
</code></pre>
<p><img src="images/nu5.png" alt="nu5"></p>
<ul>
<li>The <code>ns</code> command is designed to search for Nix packages using <code>nix search</code> and
present the results in a cleaner format, specifically removing the
architecture and operating system prefix that nix search often includes.</li>
</ul>
<details>
<summary> ‚úîÔ∏è Click To Expand</summary>
<pre><code class="language-nu">def ns [
    term: string # Search target.
] {

    let info = (
        sysctl -n kernel.arch kernel.ostype
        | lines
        | {arch: ($in.0|str downcase), ostype: ($in.1|str downcase)}
    )

    nix search --json nixpkgs $term
        | from json
        | transpose package description
        | flatten
        | select package description version
        | update package {|row| $row.package | str replace $"legacyPackages.($info.arch)-($info.ostype)." ""}
}
</code></pre>
</details>
<p><strong>Usage</strong>:</p>
<pre><code class="language-nu">ns fzf&lt;ENTER&gt;
</code></pre>
<p><img src="images/nu10.png" alt="nu10"></p>
<ul>
<li><code>nufetch</code> command:</li>
</ul>
<details>
<summary> ‚úîÔ∏è Click To Expand</summary>
<pre><code class="language-nu"># `nufetch` `(nufetch).packages`
def nufetch [] {
{
"kernel": $nu.os-info.kernel_version,
"nu": $env.NU_VERSION,
"packages": (ls /etc/profiles/per-user | select name | prepend [[name];
["/run/current-system/sw"]] | each { insert "number" (nix path-info --recursive
 ($in | get name) | lines | length) | insert "size" ( nix path-info -S
 ($in | get name) | parse -r '\s(.*)' | get capture0.0 | into filesize) | update
 "name" ($in | get name | parse -r '.*/(.*)' | get capture0.0 | if $in == "sw"
 {"system"} else {$in}) | rename "environment"}),
"uptime": (sys host).uptime
}
}
</code></pre>
</details>
<p><img src="images/nu1.png" alt="nu1"></p>
<ul>
<li><code>duf</code> command, I have mine aliased to <code>df</code>:</li>
</ul>
<p><img src="images/nu8.png" alt="nu8"></p>
<ul>
<li><code>ps</code> command:</li>
</ul>
<p><img src="images/ps.png" alt="ps"></p>
<ul>
<li><code>nix-list-system</code> command lists all installed packages:</li>
</ul>
<pre><code class="language-nu"># list all installed packages
def nix-list-system []: nothing -&gt; list&lt;string&gt; {
  ^nix-store -q --references /run/current-system/sw
  | lines
  | filter { not ($in | str ends-with 'man') }
  | each { $in | str replace -r '^[^-]*-' '' }
  | sort
}
</code></pre>
<p><strong>Usage</strong>:</p>
<pre><code class="language-bash">nix-list-system
</code></pre>
<p><img src="images/nu6.png" alt="nu6"></p>
<ul>
<li>These custom Nushell commands showcase its flexibility, but sometimes you need
to work around Nushell‚Äôs limitations, like compatability with certain NixOS
tools. This is where <code>just</code> and <code>justfiles</code> come in, simplifying complex
workflows and bridging gaps in Nushell‚Äôs functionality.</li>
</ul>
<h2 id="using-just-and-justfiles"><a class="header" href="#using-just-and-justfiles">Using Just and Justfiles</a></h2>
<ul>
<li>
<p>The following is my <code>justfile</code> that I keep right next to my <code>flake.nix</code> it
simplifies some commands and makes things work that weren‚Äôt working with
nushell for my case, you‚Äôll have to change it to match your configuration.
It‚Äôs not perfect but works for my use case, take whats useful and leave the
rest.</p>
</li>
<li>
<p>You‚Äôll first need to install <a href="https://github.com/casey/just">just</a> to make use
of <code>justfiles</code>.</p>
</li>
</ul>
<pre><code class="language-bash"># nix shell nixpkgs#just nixpkgs#nushell
set shell := ["nu", "-c"]
flake_path := "/home/jr/flake"
hostname := "magic"
home_manager_output := "jr@magic"

utils_nu := absolute_path("utils.nu")

default:
    @just --list
# Rebuild
[group('nix')]
fr:
    nh os switch --hostname {{hostname}} {{flake_path}}

# Flake Update
[group('nix')]
fu:
    nh os switch  --hostname {{hostname}} --update {{flake_path}}

# Update specific input
# Usage: just upp nixpkgs
[group('nix')]
upp input:
    nix flake update {{input}}
# Test
[group('nix')]
ft:
    nh os test --hostname {{hostname}} {{flake_path}}
# Collect Garbage
[group('nix')]
ncg:
    nix-collect-garbage --delete-old ; sudo nix-collect-garbage -d ; sudo /run/current-system/bin/switch-to-configuration boot

[group('nix')]
cleanup:
    nh clean all

</code></pre>
<ul>
<li>To list available commands type, (you must be in the same directory as the
justfile): <code>just</code></li>
</ul>
<p><img src="images/just2.png" alt="just"></p>
<ul>
<li>
<p>So <code>just fmt</code> will run <code>nix fmt</code>.</p>
</li>
<li>
<p>A lot of the <code>.nu</code> files came from this repo by BlindFS:</p>
<ul>
<li>
<p><a href="https://github.com/blindFS/modern-dot-files/tree/main">modern-dot-files</a> he
uses Nix Darwin so there are a few changes for NixOS. I found this through
<a href="https://github.com/nushell/this_week_in_nu">this_week_in_nu</a>.</p>
</li>
<li>
<p><a href="https://github.com/TSawyer87/flakes/tree/main/homeManagerModules/shells/nushell">my-nu-config</a>
If you use this, you‚Äôll need to change the first line of <code>fzf.nu</code> to the
location of your config. You‚Äôll also need to change the constants at the top
of <code>config.nu</code>. These are my old dotfiles, I have recently updated and made
sure this config is up to date with recent nushell changes. Also, change the
<code>let flake_path = ($env.HOME | path join "flake")</code> to your flake path.</p>
</li>
<li>
<p>The examples use this starship
config<a href="https://github.com/Aylur/dotfiles/blob/main/home/starship.nix">Aylur-dotfiles</a>
The logic on the bottom enables starship for Nushell, Zsh, and Bash!</p>
</li>
<li>
<p>If you wan‚Äôt to use my config you‚Äôll have to enable the experimental-feature
<code>pipe-operators</code> in the same place you enable flakes and nix-command.</p>
</li>
</ul>
</li>
<li>
<p>There are still situations where I need to switch to zsh or bash to get
something to work i.e. <code>nix-shell</code> and a few others.</p>
</li>
<li>
<p>From custom commands to <code>justfile</code> integrations, Nushell offers a wealth of
tools to enhance your NixOS experience, even if occasional workarounds are
needed. To dive deeper into Nushell and tailor it to your needs, here are some
valuable resources to explore, from official documentation to community-driven
configurations.</p>
</li>
</ul>
<h4 id="resources"><a class="header" href="#resources">Resources</a></h4>
<details>
<summary> ‚úîÔ∏è Click to Expand Resources </summary>
<ul>
<li>
<p><a href="https://www.nushell.sh/book/">Nushell-Book</a></p>
</li>
<li>
<p><a href="https://www.nushell.sh/cookbook/">Nushell-Cookbook</a></p>
</li>
<li>
<p><a href="https://github.com/nushell/nu_scripts">nu_scripts</a> some of the custom
commands came from here.</p>
</li>
<li>
<p><a href="https://github.com/nushell/nushell/tree/main/crates/nu-utils/src/default_files">nushell sample-config</a></p>
</li>
<li>
<p><a href="https://github.com/nushell/awesome-nu#plugins">awesome-nu repo</a></p>
</li>
<li>
<p><a href="https://github.com/nushell/showcase">nu showcase-repo</a></p>
</li>
<li>
<p><a href="https://discord.com/invite/NtAbbGn">discord</a> You can find custom commands,
configurations, etc here.</p>
</li>
</ul>
</details>
<footer id="kanagawa-support-footer" style="text-align:center; margin-top: 3rem; font-size: 0.85em; opacity: 0.75;">
  
<p><a href="https://github.com/saylesss88/mdbook-kanagawa-theme">Made with mdbook-kanagawa-theme</a></p>

</footer>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="Nix_Pull_Requests_11.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg></span>
                            </a>

                            <a rel="next prefetch" href="nixos_containers.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"/></svg></span>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="Nix_Pull_Requests_11.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg></span>
                    </a>

                    <a rel="next prefetch" href="nixos_containers.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"/></svg></span>
                    </a>
            </nav>

        </div>

        <template id=fa-eye><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144s64.5-144 144-144s144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64c-11.5 0-22.3-3-31.6-8.4c-.2 2.8-.4 5.5-.4 8.4c0 53 43 96 96 96s96-43 96-96s-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6z"/></svg></span></template>
        <template id=fa-eye-slash><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M38.8 5.1C28.4-3.1 13.3-1.2 5.1 9.2S-1.2 34.7 9.2 42.9l592 464c10.4 8.2 25.5 6.3 33.7-4.1s6.3-25.5-4.1-33.7L525.6 386.7c39.6-40.6 66.4-86.1 79.9-118.4c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C465.5 68.8 400.8 32 320 32c-68.2 0-125 26.3-169.3 60.8L38.8 5.1zM223.1 149.5C248.6 126.2 282.7 112 320 112c79.5 0 144 64.5 144 144c0 24.9-6.3 48.3-17.4 68.7L408 294.5c5.2-11.8 8-24.8 8-38.5c0-53-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6c0 10.2-2.4 19.8-6.6 28.3l-90.3-70.8zm223.1 298L373 389.9c-16.4 6.5-34.3 10.1-53 10.1c-79.5 0-144-64.5-144-144c0-6.9 .5-13.6 1.4-20.2L83.1 161.5C60.3 191.2 44 220.8 34.5 243.7c-3.3 7.9-3.3 16.7 0 24.6c14.9 35.7 46.2 87.7 93 131.1C174.5 443.2 239.2 480 320 480c47.8 0 89.9-12.9 126.2-32.5z"/></svg></span></template>
        <template id=fa-copy><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M502.6 70.63l-61.25-61.25C435.4 3.371 427.2 0 418.7 0H255.1c-35.35 0-64 28.66-64 64l.0195 256C192 355.4 220.7 384 256 384h192c35.2 0 64-28.8 64-64V93.25C512 84.77 508.6 76.63 502.6 70.63zM464 320c0 8.836-7.164 16-16 16H255.1c-8.838 0-16-7.164-16-16L239.1 64.13c0-8.836 7.164-16 16-16h128L384 96c0 17.67 14.33 32 32 32h47.1V320zM272 448c0 8.836-7.164 16-16 16H63.1c-8.838 0-16-7.164-16-16L47.98 192.1c0-8.836 7.164-16 16-16H160V128H63.99c-35.35 0-64 28.65-64 64l.0098 256C.002 483.3 28.66 512 64 512h192c35.2 0 64-28.8 64-64v-32h-47.1L272 448z"/></svg></span></template>
        <template id=fa-play><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M73 39c-14.8-9.1-33.4-9.4-48.5-.9S0 62.6 0 80V432c0 17.4 9.4 33.4 24.5 41.9s33.7 8.1 48.5-.9L361 297c14.3-8.7 23-24.2 23-41s-8.7-32.2-23-41L73 39z"/></svg></span></template>
        <template id=fa-clock-rotate-left><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M75 75L41 41C25.9 25.9 0 36.6 0 57.9V168c0 13.3 10.7 24 24 24H134.1c21.4 0 32.1-25.9 17-41l-30.8-30.8C155 85.5 203 64 256 64c106 0 192 86 192 192s-86 192-192 192c-40.8 0-78.6-12.7-109.7-34.4c-14.5-10.1-34.4-6.6-44.6 7.9s-6.6 34.4 7.9 44.6C151.2 495 201.7 512 256 512c141.4 0 256-114.6 256-256S397.4 0 256 0C185.3 0 121.3 28.7 75 75zm181 53c-13.3 0-24 10.7-24 24V256c0 6.4 2.5 12.5 7 17l72 72c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-65-65V152c0-13.3-10.7-24-24-24z"/></svg></span></template>



        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr-ef4e11c1.min.js"></script>
        <script src="mark-09e88c2c.min.js"></script>
        <script src="searcher-c2a407aa.js"></script>

        <script src="clipboard-1626706a.min.js"></script>
        <script src="highlight-abc7f01d.js"></script>
        <script src="book-a0b12cfe.js"></script>

        <!-- Custom JS scripts -->
        <script src="theme/extra-7c6a362d.js"></script>
        <script src="theme/rss-button-131cc4a8.js"></script>
        <script src="theme/nix_http-971fb95c.js"></script>



    </div>
    
<!-- mdbook-nix-repl config -->
<script>
  window.NIX_REPL_ENDPOINT = "http://127.0.0.1:8080/";
  window.NIX_REPL_TOKEN = "9deb7efadb74b9e962e7911bb5dcf3b1fef278a1d915b526";
</script>

</body>
</html>
