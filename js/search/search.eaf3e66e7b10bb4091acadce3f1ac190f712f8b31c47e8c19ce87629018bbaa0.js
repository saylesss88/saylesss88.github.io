(()=>{var l=20;(function(){let i=new FlexSearch.Document({document:{id:"id",index:["title","tags","content","date"],store:["title","summary","date","permalink"]},tokenize:"forward"});function m(e){let n=document.querySelector("template").content,t=document.createDocumentFragment(),c=document.querySelector(".search-results");c.textContent="";for(let a in e){let o=e[a],r=n.cloneNode(!0),d=r.querySelector("a"),q=r.querySelector("time"),y=r.querySelector(".content");d.innerHTML=o.title,d.href=o.permalink,q.innerText=o.date,y.innerHTML=o.summary,t.appendChild(r)}c.appendChild(t)}function s(e){let n=e||document.querySelector(".search-text").value.trim(),t=i.search({query:n,enrich:!0,limit:l}),c={};t.forEach(function(a){a.result.forEach(function(o){c[o.doc.permalink]=o.doc})}),m(c)}function h(e){e.addEventListener("submit",function(n){n.preventDefault(),s()}),e.addEventListener("input",function(){s()}),document.querySelector(".search-loading").classList.add("hidden"),document.querySelector(".search-bar").classList.remove("hidden"),document.querySelector(".search-text").focus()}function f(e){let n="/index.json";document.querySelector(".search-loading").classList.remove("hidden"),fetch(n).then(function(t){return t.json()}).then(function(t){t.forEach(function(c){i.add(c)})}).then(e)}let u=document.querySelector(".search-form");u&&(f(function(){let e=new URLSearchParams(window.location.search).get("q");document.querySelector(".search-text").value=e||"",s(e)}),h(u))})();})();
