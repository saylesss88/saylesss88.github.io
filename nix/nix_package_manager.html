<!DOCTYPE HTML>
<html lang="en" class="navy sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Nix Package Manager - nix-book</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon-de23e50b.svg">
        <link rel="shortcut icon" href="../favicon-8114d1fc.png">
        <link rel="stylesheet" href="../css/variables-8adf115d.css">
        <link rel="stylesheet" href="../css/general-2459343d.css">
        <link rel="stylesheet" href="../css/chrome-c9668816.css">
        <link rel="stylesheet" href="../css/print-9e4910d8.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../fonts/fonts-9644e21d.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="mdbook-highlight-css" href="../highlight-493f70e1.css">
        <link rel="stylesheet" id="mdbook-tomorrow-night-css" href="../tomorrow-night-4c0ae647.css">
        <link rel="stylesheet" id="mdbook-ayu-highlight-css" href="../ayu-highlight-3fdfc3ac.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../theme/extra-c3f37c9a.css">
        <link rel="stylesheet" href="../theme/rss-button-d84d8455.css">


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "navy";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "../searchindex-b6d32fd6.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc-e88b5bcf.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="mdbook-body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('navy')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="mdbook-sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("mdbook-sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="mdbook-sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="mdbook-sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="mdbook-page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="mdbook-menu-bar-hover-placeholder"></div>
                <div id="mdbook-menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="mdbook-sidebar-toggle" class="icon-button" for="mdbook-sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="mdbook-sidebar">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"/></svg></span>
                        </label>
                        <button id="mdbook-theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="mdbook-theme-list">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M371.3 367.1c27.3-3.9 51.9-19.4 67.2-42.9L600.2 74.1c12.6-19.5 9.4-45.3-7.6-61.2S549.7-4.4 531.1 9.6L294.4 187.2c-24 18-38.2 46.1-38.4 76.1L371.3 367.1zm-19.6 25.4l-116-104.4C175.9 290.3 128 339.6 128 400c0 3.9 .2 7.8 .6 11.6c1.8 17.5-10.2 36.4-27.8 36.4H96c-17.7 0-32 14.3-32 32s14.3 32 32 32H240c61.9 0 112-50.1 112-112c0-2.5-.1-5-.2-7.5z"/></svg></span>
                        </button>
                        <ul id="mdbook-theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-ayu">Ayu</button></li>
                        </ul>
                        <button id="mdbook-search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="mdbook-searchbar">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352c79.5 0 144-64.5 144-144s-64.5-144-144-144S64 128.5 64 208s64.5 144 144 144z"/></svg></span>
                        </button>
                    </div>

                    <h1 class="menu-title">nix-book</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <span class=fa-svg id="print-button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M128 0C92.7 0 64 28.7 64 64v96h64V64H354.7L384 93.3V160h64V93.3c0-17-6.7-33.3-18.7-45.3L400 18.7C388 6.7 371.7 0 354.7 0H128zM384 352v32 64H128V384 368 352H384zm64 32h32c17.7 0 32-14.3 32-32V256c0-35.3-28.7-64-64-64H64c-35.3 0-64 28.7-64 64v96c0 17.7 14.3 32 32 32H64v64c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V384zm-16-88c-13.3 0-24-10.7-24-24s10.7-24 24-24s24 10.7 24 24s-10.7 24-24 24z"/></svg></span>
                        </a>

                    </div>
                </div>

                <div id="mdbook-search-wrapper" class="hidden">
                    <form id="mdbook-searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="mdbook-searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="mdbook-searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <span class=fa-svg id="fa-spin"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M304 48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zm0 416c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM48 304c26.5 0 48-21.5 48-48s-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48zm464-48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM142.9 437c18.7-18.7 18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zm0-294.2c18.7-18.7 18.7-49.1 0-67.9S93.7 56.2 75 75s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zM369.1 437c18.7 18.7 49.1 18.7 67.9 0s18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9z"/></svg></span>
                            </div>
                        </div>
                    </form>
                    <div id="mdbook-searchresults-outer" class="searchresults-outer hidden">
                        <div id="mdbook-searchresults-header" class="searchresults-header"></div>
                        <ul id="mdbook-searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('mdbook-sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('mdbook-sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#mdbook-sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="mdbook-content" class="content">
                    <main>
                        <h1 id="nix-package-manager"><a class="header" href="#nix-package-manager">Nix Package Manager</a></h1>
<details>
<summary> Click to Expand Table of Contents</summary>
<ul>
<li><a href="#nix-package-manager">Nix Package Manager</a></li>
<li><a href="#channels">Channels</a></li>
<li><a href="#channels-vs-flakes-enhancing-reproducibility">Channels vs. Flakes Enhancing Reproducibility</a></li>
<li><a href="#nixpkgs">Nixpkgs</a>
<ul>
<li><a href="#updates">Updates</a>
<ul>
<li><a href="#updating-with-channels-traditional-approach">Updating with Channels (Traditional Approach)</a></li>
<li><a href="#updating-with-flakes-modern-approach">Updating with Flakes (Modern Approach)</a></li>
</ul>
</li>
<li><a href="#managing-software-with-nix">Managing software with Nix</a></li>
</ul>
</li>
</ul>
</details>
<!-- ![nix99](../images/nix99.png) -->
<h2 id="nix-package-manager-1"><a class="header" href="#nix-package-manager-1">Nix Package Manager</a></h2>
<p>Nix is a <em>purely functional package manager</em>. This means that it treats packages
like values in purely functional programming languages – they are built by
functions that don’t have side-effects, and they never change after they have
been built.</p>
<p>Nix stores packages in the <em>Nix store</em>, usually the directory <code>/nix/store</code>,
where each package has its own unique subdirectory such as:</p>
<pre><code class="language-bash">/nix/store/y53c0lamag5wpx7vsiv7wmnjdgq97yd6-yazi-25.5.14pre20250526_74a8ea9
</code></pre>
<p>You can use the Nix on most Linux distributions and Mac OS also has good support
for Nix. It should work on most platforms that support POSIX threads and have a
C++11 compiler.</p>
<p>When I install Nix on a distro like Arch Linux I usually use the Zero to Nix
installer as it automates several steps, such as enabling flakes by default:</p>
<pre><code class="language-bash">curl --proto '=https' --tlsv1.2 -sSf -L https://install.determinate.systems/nix | sh -s -- install
</code></pre>
<p>If you have concerns about the “curl to Bash” approach you could examine the
installation script
<a href="https://raw.githubusercontent.com/DeterminateSystems/nix-installer/main/nix-installer.sh">here</a>
then download and run it:</p>
<pre><code class="language-bash">curl --proto '=https' --tlsv1.2 -sSf -L https://install.determinate.systems/nix &gt; nix-installer.sh
chmod +x nix-installer.sh
./nix-installer.sh install
</code></pre>
<p>I got the above commands from
<a href="https://zero-to-nix.com/start/install/">zero-to-nix</a></p>
<p>The main difference between using the nix package manager on another
distribution and NixOS is that NixOS uses Nix not just for package management
but also to manage the system configuration (e.g., to build config files in
<code>/etc</code>).</p>
<p><a href="https://nix-community.github.io/home-manager/">Home Manager</a> is a Nix-powered
tool for reproducible management of the contents of the users’ home directories.
This includes programs, configuration files, environment variables, and
arbitrary files. Home manager uses the same module system as NixOS.</p>
<p>Now that we’ve discussed some of the basics of the Nix package manager, lets see
how it is used to build and manage software in NixOS.</p>
<h2 id="channels"><a class="header" href="#channels">Channels</a></h2>
<p>Nix packages are distributed through Nix channels; mechanisms for distributing
Nix expressions and the associated binary caches for them. Channels are what
determine which versions your packages have. (i.e. <em>stable</em> or <em>unstable</em>). A
channel is a name for the latest “verified” git commits in Nixpkgs. Each channel
represents a different policy for what “verified” means. Whenever a new commit
in <code>Nixpkgs</code> passes the verification process, the respective channel is updated
to point to that new commit.</p>
<p>While channels provide a convenient way to get the latest stable or unstable
packages, they introduce a challenge for strict reproducibility. Because a
channel like <code>nixos-unstable</code> is constantly updated, fetching packages from it
today might give you a different set of package versions than fetching from it
tomorrow, even if your configuration remains unchanged. This “rolling release”
nature at a global level can make it harder to share and reproduce exact
development environments or system configurations across different machines or
at different points in time.</p>
<h2 id="channels-vs-flakes-enhancing-reproducibility"><a class="header" href="#channels-vs-flakes-enhancing-reproducibility">Channels vs. Flakes Enhancing Reproducibility</a></h2>
<p>Before the introduction of <strong>Nix Flakes</strong>, channels were the primary mechanism
for sourcing <code>Nixpkgs</code>. While functional, they posed a challenge for exact
reproducibility because they point to a moving target (the latest commit on a
branch). This meant that a <code>nix-build</code> command run yesterday might produce a
different result than one run today, simply because the channel updated.</p>
<p>Nix Flakes were introduced to address this. Flakes bring a built-in,
standardized way to define the exact inputs to a Nix build, including the
precise Git revision of <code>Nixpkgs</code> or any other dependency.</p>
<p>Here’s a quick comparison:</p>
<div class="table-wrapper">
<table>
<thead>
<tr><th style="text-align: left">Feature</th><th style="text-align: left">Nix Channels (traditional)</th><th style="text-align: left">Nix Flakes (modern approach)</th></tr>
</thead>
<tbody>
<tr><td style="text-align: left"><strong>Input Source</strong></td><td style="text-align: left">Global system configuration (<code>nix-channel --update</code>)</td><td style="text-align: left">Explicitly defined in <code>flake.nix</code> (e.g., <code>github:NixOS/nixpkgs/nixos-23.11</code>)</td></tr>
<tr><td style="text-align: left"><strong>Reproducibility</strong></td><td style="text-align: left">“Rolling release”; less reproducible across time/machines</td><td style="text-align: left">Highly reproducible due to locked inputs (<code>flake.lock</code>)</td></tr>
<tr><td style="text-align: left"><strong>Dependency Mgmt.</strong></td><td style="text-align: left">Implicitly managed by global channel</td><td style="text-align: left">Explicitly declared and version-locked within <code>flake.nix</code></td></tr>
<tr><td style="text-align: left"><strong>Sharing</strong></td><td style="text-align: left">Relies on users having same channel version</td><td style="text-align: left">Self-contained; <code>flake.lock</code> ensures everyone gets same inputs</td></tr>
<tr><td style="text-align: left"><strong>Learning Curve</strong></td><td style="text-align: left">Simpler initial setup, but tricky reproducibility debugging</td><td style="text-align: left">Higher initial learning curve, but simplifies reproducibility</td></tr>
</tbody>
</table>
</div>
<p>The ability of Flakes to “lock” the exact version of all dependencies in a
<code>flake.lock</code> file is a game-changer for collaboration and long-term
reproducibility, ensuring that your Nix configuration builds the same way, every
time, everywhere.</p>
<h2 id="nixpkgs"><a class="header" href="#nixpkgs">Nixpkgs</a></h2>
<p><strong>Nixpkgs</strong> is the largest repository of Nix packages and NixOS modules.</p>
<p>For <strong>NixOS</strong> users, <code>nixos-unstable</code> channel branch is the rolling release,
where the packages are tested and must pass integration tests.</p>
<p>For <strong>standalone Nix</strong> users, <code>nixpkgs-unstable</code> channel branch is the rolling
release, where packages pass only basic build tests and are upgraded often.</p>
<p>For Flakes, as mentioned above they don’t use channels so <code>nixpkgs</code> will be
listed as an <code>input</code> to your flake. (e.g.,
<code>inputs.nixpkgs.url = "github:nixos/nixpkgs/nixos-unstable";</code>) When using flakes
you can actually disable channels and actually recommended to avoid conflicts
between traditional channel-based workflows and the flake system.</p>
<h3 id="updates"><a class="header" href="#updates">Updates</a></h3>
<p>The mechanism for updating your Nix environment differs fundamentally between
channels and flakes, directly impacting reproducibility and control.</p>
<h4 id="updating-with-channels-traditional-approach"><a class="header" href="#updating-with-channels-traditional-approach">Updating with Channels (Traditional Approach)</a></h4>
<p>With channels, updates are a global operation that pulls the latest state of a
specific branch.</p>
<p><strong>How it works</strong>: You typically use <code>nix-channel --update</code> to fetch the latest
commit from the channels you’ve subscribed to. For instance,
<code>sudo nix-channel --update nixos</code> (for NixOS) or <code>nix-channel --update nixpkgs</code>
(for <code>nix-env</code> on other Linux distributions).</p>
<p><strong>Implication</strong>: This command updates your local system’s understanding of what
“nixos” or “nixpkgs-unstable” means. From that point on, any
<code>nixos-rebuild switch</code>, <code>nix-env -iA</code>, or <code>nix-build</code> commands that implicitly
or explicitly refer to <code>nixpkgs</code> will use this newly updated version.</p>
<p><strong>Reproducibility Challenge</strong>: The update itself is not recorded in your
configuration files. If you share your <code>configuration.nix</code> with someone, they
might run <code>nix-channel --update</code> on a different day and get a different set of
package versions because the channel has moved. This makes it challenging to
guarantee that two users building the “same” configuration will get identical
results. You’re effectively relying on the implicit, globally managed state of
your channels.</p>
<h4 id="updating-with-flakes-modern-approach"><a class="header" href="#updating-with-flakes-modern-approach">Updating with Flakes (Modern Approach)</a></h4>
<p><strong>Flakes</strong>, by contrast, use a more explicit and localized update mechanism tied
to your <code>flake.lock</code> file.</p>
<p><strong>How it works</strong>: When you define a <code>flake.nix</code>, you specify the exact URL
(e.g., a Git repository with a specific branch or tag) for each input. When you
first use a flake, Nix resolves these URLs to a precise Git commit hash and
records this hash, along with a content hash, in a <code>flake.lock</code> file.</p>
<p>To update your flake inputs, you run <code>nix flake update</code>.</p>
<p><strong>Implication</strong>: This command goes to each input’s specified URL (e.g.,
<code>github:NixOS/nixpkgs/nixos-unstable</code>) and fetches the latest commit for that
input. It then updates your <code>flake.lock</code> file with the new, precise Git commit
hash and content hash for that input. Your <code>flake.nix</code> itself doesn’t change,
but the <code>flake.lock</code> file now points to newer versions of your dependencies.</p>
<p><strong>Reproducibility Advantage</strong>: The <code>flake.lock</code> file acts as a manifest of your
exact dependency versions.</p>
<p><strong>Sharing</strong>: When you share your flake (the <code>flake.nix</code> and <code>flake.lock</code> files),
anyone using it will fetch precisely the same Git commit hashes recorded in the
<code>flake.lock</code>, guaranteeing identical inputs and thus, identical builds (assuming
the same system architecture).</p>
<p><strong>Updating Selectively</strong>: You can update individual inputs within your flake by
specifying them: <code>nix flake update nixpkgs</code>. This provides fine-grained control
over which parts of your dependency graph you want to advance.</p>
<p><strong>Rolling Back</strong>: Because the <code>flake.lock</code> explicitly records the versions, you
can easily revert to a previous state by checking out an older <code>flake.lock</code> from
your version control system.</p>
<p><strong>In essence</strong>: Channels involve a global “pull” of the latest branch state,
making reproducibility harder to guarantee across time and machines. Flakes,
however, explicitly pin all inputs in <code>flake.lock</code>, and updates involve
explicitly refreshing these pins, providing strong reproducibility and version
control out of the box.</p>
<h3 id="managing-software-with-nix"><a class="header" href="#managing-software-with-nix">Managing software with Nix</a></h3>
<p><strong>Derivation Overview</strong></p>
<p>In Nix, the process of managing software starts with <strong>package definitions</strong>.
These are files written in the Nix language that describe how a particular piece
of software should be built. These package definitions, when processed by Nix,
are translated into derivations.</p>
<p>At its core, a derivation in Nix is a blueprint or a recipe that describes how
to build a specific software package or any other kind of file or directory.
It’s a declarative specification of:</p>
<ul>
<li>
<p><strong>Inputs</strong>: What existing files or other derivations are needed as
dependencies.</p>
</li>
<li>
<p><strong>Build Steps</strong>: The commands that need to be executed to produce the desired
output.</p>
</li>
<li>
<p><strong>Environment</strong>: The specific environment (e.g., build tools, environment
variables) required for the build process.</p>
</li>
<li>
<p><strong>Outputs</strong>: The resulting files or directories that the derivation produces.</p>
</li>
</ul>
<p>Think of a package definition as the initial instructions, and the derivation as
the detailed, low-level plan that Nix uses to actually perform the build.</p>
<p>Again, a derivation is like a blueprint that describes how to build a specific
software package or any other kind of file or directory.</p>
<p><strong>Key Characteristics of Derivations:</strong></p>
<ul>
<li>
<p><strong>Declarative</strong>: You describe the desired outcome and the inputs, not the
exact sequence of imperative steps. Nix figures out the necessary steps based
on the builder and args.</p>
</li>
<li>
<p><strong>Reproducible</strong>: Given the same inputs and build instructions, a derivation
will always produce the same output. This is a cornerstone of Nix’s
reproducibility.</p>
</li>
<li>
<p><strong>Tracked by Nix</strong>: Nix keeps track of all derivations and their outputs in
the Nix store. This allows for efficient management of dependencies and
ensures that different packages don’t interfere with each other.</p>
</li>
<li>
<p><strong>Content-Addressed</strong>: The output of a derivation is stored in the Nix store
under a unique path that is derived from the hash of all its inputs and build
instructions. This means that if anything changes in the derivation, the
output will have a different path.</p>
</li>
</ul>
<p>Here’s a simple Nix derivation that creates a file named hello in the Nix store
containing the text “Hello, World!”:</p>
<details>
<summary> ✔️ Hello World Derivation Example (Click to expand):</summary>
<pre><code class="language-nix">{pkgs ? import &lt;nixpkgs&gt; {}}:
pkgs.stdenv.mkDerivation {
  name = "hello-world";

  dontUnpack = true;

  # No need for src = null; when dontUnpack = true;
  # src = null;

  buildPhase = ''
     # Create a shell script that prints "Hello, World!"
    echo '#!${pkgs.bash}/bin/bash' &gt; hello-output-file # Shebang line
    echo 'echo "Hello, World!"' &gt;&gt; hello-output-file # The command to execute
    chmod +x hello-output-file # Make it executable
  '';

  installPhase = ''
    mkdir -p $out/bin
    cp hello-output-file $out/bin/hello # Copy the file from build directory to $out/bin
  '';

  meta = {
    description = "A simple Hello World program built with Nix";
    homepage = null;
    license = pkgs.lib.licenses.unfree; # licenses.mit is often used as well
    maintainers = [];
  };
}
</code></pre>
<p>And a <code>default.nix</code> with the following contents:</p>
<pre><code class="language-nix">{ pkgs ? import &lt;nixpkgs&gt; {} }:

import ./hello.nix { pkgs = pkgs; }
</code></pre>
<ul>
<li>
<p><code>{ pkgs ? import &lt;nixpkgs&gt; {} }</code>: This is a function that takes an optional
argument <code>pkgs</code>. We need Nixpkgs to access standard build environments like
<code>stdenv</code>.</p>
</li>
<li>
<p><code>pkgs.stdenv.mkDerivation { ... }:</code> This calls the mkDerivation function from
the standard environment (stdenv). mkDerivation is the most common way to
define software packages in Nix.</p>
</li>
<li>
<p><code>name = "hello-world";</code>: Human-readable name of the derivation</p>
</li>
<li>
<p>The rest are the build phases and package metadata.</p>
</li>
</ul>
<p>To use the above derivation, save it as a <code>.nix</code> file (e.g. <code>hello.nix</code>). Then
build the derivation using,:</p>
<pre><code class="language-bash">nix-build
this derivation will be built:
  /nix/store/9mc855ijjdy3r6rdvrbs90cg2gf2q160-hello-world.drv
building '/nix/store/9mc855ijjdy3r6rdvrbs90cg2gf2q160-hello-world.drv'...
Running phase: patchPhase
Running phase: updateAutotoolsGnuConfigScriptsPhase
Running phase: configurePhase
no configure script, doing nothing
Running phase: buildPhase
Running phase: installPhase
Running phase: fixupPhase
shrinking RPATHs of ELF executables and libraries in /nix/store/2ydxh5pd9a6djv7npaqi9rm6gmz2f73b-hello-world
checking for references to /build/ in /nix/store/2ydxh5pd9a6djv7npaqi9rm6gmz2f73b-hello-world...
patching script interpreter paths in /nix/store/2ydxh5pd9a6djv7npaqi9rm6gmz2f73b-hello-world
stripping (with command strip and flags -S -p) in  /nix/store/2ydxh5pd9a6djv7npaqi9rm6gmz2f73b-hello-world/bin
/nix/store/2ydxh5pd9a6djv7npaqi9rm6gmz2f73b-hello-world
</code></pre>
<ul>
<li>
<p>Nix will execute the <code>buildPhase</code> and <code>installPhase</code></p>
</li>
<li>
<p>After a successful build, the output will be in the Nix store. You can find
the exact path by looking at the output of the nix build command (it will be
something like <code>/nix/store/your-hash-hello-world</code>).</p>
</li>
</ul>
<p>Run the “installed” program:</p>
<pre><code class="language-bash">./result/bin/hello
</code></pre>
<ul>
<li>This will execute the <code>hello</code> file from the Nix store and print
<code>"Hello, World!"</code>.</li>
</ul>
</details>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../nix/nix_language.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg></span>
                            </a>

                            <a rel="next prefetch" href="../nix/cachix_devour.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"/></svg></span>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../nix/nix_language.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg></span>
                    </a>

                    <a rel="next prefetch" href="../nix/cachix_devour.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"/></svg></span>
                    </a>
            </nav>

        </div>

        <template id=fa-eye><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144s64.5-144 144-144s144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64c-11.5 0-22.3-3-31.6-8.4c-.2 2.8-.4 5.5-.4 8.4c0 53 43 96 96 96s96-43 96-96s-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6z"/></svg></span></template>
        <template id=fa-eye-slash><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M38.8 5.1C28.4-3.1 13.3-1.2 5.1 9.2S-1.2 34.7 9.2 42.9l592 464c10.4 8.2 25.5 6.3 33.7-4.1s6.3-25.5-4.1-33.7L525.6 386.7c39.6-40.6 66.4-86.1 79.9-118.4c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C465.5 68.8 400.8 32 320 32c-68.2 0-125 26.3-169.3 60.8L38.8 5.1zM223.1 149.5C248.6 126.2 282.7 112 320 112c79.5 0 144 64.5 144 144c0 24.9-6.3 48.3-17.4 68.7L408 294.5c5.2-11.8 8-24.8 8-38.5c0-53-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6c0 10.2-2.4 19.8-6.6 28.3l-90.3-70.8zm223.1 298L373 389.9c-16.4 6.5-34.3 10.1-53 10.1c-79.5 0-144-64.5-144-144c0-6.9 .5-13.6 1.4-20.2L83.1 161.5C60.3 191.2 44 220.8 34.5 243.7c-3.3 7.9-3.3 16.7 0 24.6c14.9 35.7 46.2 87.7 93 131.1C174.5 443.2 239.2 480 320 480c47.8 0 89.9-12.9 126.2-32.5z"/></svg></span></template>
        <template id=fa-copy><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M502.6 70.63l-61.25-61.25C435.4 3.371 427.2 0 418.7 0H255.1c-35.35 0-64 28.66-64 64l.0195 256C192 355.4 220.7 384 256 384h192c35.2 0 64-28.8 64-64V93.25C512 84.77 508.6 76.63 502.6 70.63zM464 320c0 8.836-7.164 16-16 16H255.1c-8.838 0-16-7.164-16-16L239.1 64.13c0-8.836 7.164-16 16-16h128L384 96c0 17.67 14.33 32 32 32h47.1V320zM272 448c0 8.836-7.164 16-16 16H63.1c-8.838 0-16-7.164-16-16L47.98 192.1c0-8.836 7.164-16 16-16H160V128H63.99c-35.35 0-64 28.65-64 64l.0098 256C.002 483.3 28.66 512 64 512h192c35.2 0 64-28.8 64-64v-32h-47.1L272 448z"/></svg></span></template>
        <template id=fa-play><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M73 39c-14.8-9.1-33.4-9.4-48.5-.9S0 62.6 0 80V432c0 17.4 9.4 33.4 24.5 41.9s33.7 8.1 48.5-.9L361 297c14.3-8.7 23-24.2 23-41s-8.7-32.2-23-41L73 39z"/></svg></span></template>
        <template id=fa-clock-rotate-left><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M75 75L41 41C25.9 25.9 0 36.6 0 57.9V168c0 13.3 10.7 24 24 24H134.1c21.4 0 32.1-25.9 17-41l-30.8-30.8C155 85.5 203 64 256 64c106 0 192 86 192 192s-86 192-192 192c-40.8 0-78.6-12.7-109.7-34.4c-14.5-10.1-34.4-6.6-44.6 7.9s-6.6 34.4 7.9 44.6C151.2 495 201.7 512 256 512c141.4 0 256-114.6 256-256S397.4 0 256 0C185.3 0 121.3 28.7 75 75zm181 53c-13.3 0-24 10.7-24 24V256c0 6.4 2.5 12.5 7 17l72 72c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-65-65V152c0-13.3-10.7-24-24-24z"/></svg></span></template>



        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr-ef4e11c1.min.js"></script>
        <script src="../mark-09e88c2c.min.js"></script>
        <script src="../searcher-c2a407aa.js"></script>

        <script src="../clipboard-1626706a.min.js"></script>
        <script src="../highlight-abc7f01d.js"></script>
        <script src="../book-a0b12cfe.js"></script>

        <!-- Custom JS scripts -->
        <script src="../theme/extra-e0f03105.js"></script>
        <script src="../theme/rss-button-7a13e6a0.js"></script>



    </div>
    </body>
</html>
